function Dictionary(){var c=this;this.CompareMode=1;this.Count=0;this.arrKeys=new Array();this.arrValues=new Array();this.ThrowException=true;this.Item=function(f){var e=b(c.arrKeys,f);if(e!=-1){return c.arrValues[e]}else{if(c.ThrowException){throw"在获取键对应的值时发生错误，键不存在。"}}};this.Keys=function(){return c.arrKeys};this.Values=function(){return c.arrValues};this.Add=function(e,f){if(a(e)){c.arrKeys[c.Count]=e;c.arrValues[c.Count]=f;c.Count++}else{if(c.ThrowException){throw"在将键和值添加到字典时发生错误，可能是键无效或者键已经存在。"}}};this.add=function(f,g){var e=b(c.arrKeys,f);if(e!=-1){c.arrKeys.splice(e,1);c.arrValues.splice(e,1);c.Count--}if(a(f)){c.arrKeys[c.Count]=f;c.arrValues[c.Count]=g;c.Count++}else{if(c.ThrowException){throw"在将键和值添加到字典时发生错误，可能是键无效或者键已经存在。"}}};this.BatchAdd=function(g,e){var h=false;if(g!=null&&g!=undefined&&e!=null&&e!=undefined){if(g.length==e.length&&g.length>0){var f=c.arrKeys.concat(g);if(!d(f)){c.arrKeys=f;c.arrValues=c.arrValues.concat(e);c.Count=c.arrKeys.length;h=true}}}return h};this.Clear=function(){if(c.Count!=0){c.arrKeys.splice(0,c.Count);c.arrValues.splice(0,c.Count);c.Count=0}};this.ContainsKey=function(e){return b(c.arrKeys,e)!=-1};this.ContainsValue=function(e){return b(c.arrValues,e)!=-1};this.Remove=function(f){var e=b(c.arrKeys,f);if(e!=-1){c.arrKeys.splice(e,1);c.arrValues.splice(e,1);c.Count--;return true}else{return false}};this.TryGetValue=function(g,f){var e=b(c.arrKeys,g);if(e!=-1){return c.arrValues[e]}else{return f}};this.get=function(g,f){var e=b(c.arrKeys,g);if(e!=-1){return c.arrValues[e]}else{return f}};this.ToString=function(){if(c.Count==0){return""}else{return c.arrKeys.toString()+";"+c.arrValues.toString()}};function a(e){if(e==null||e==undefined||e==NaN){return false}return !c.ContainsKey(e)}function b(g,l){var f=-1;var j;if(!(g==null||g==undefined||typeof(g)!="object")){try{for(j=0;j<g.length;j++){var h;if(c.CompareMode==0){h=(g[j]===l)}else{h=(g[j]==l)}if(h){f=j;break}}}catch(k){}}return f}function d(e){var h=false;if(e!=null&&e!=undefined&&typeof(e)=="object"){var g;for(g=0;g<e.length-1;g++){var f;if(c.CompareMode==0){f=(e[g]===e[g+1])}else{f=(e[g]==e[g+1])}if(f){h=true;break}}}return h}};
;
Ext.define("Ext.plugin.DataViewPaging",{extend:"Ext.plugin.ListPaging",alias:"plugin.dataviewpaging",init:function(c){var a=c.getScrollable().getScroller(),b=c.getStore();this.setList(c);this.setScroller(a);this.bindStore(c.getStore());c.updateStore=Ext.Function.createInterceptor(c.updateStore,this.bindStore,this);if(this.getAutoPaging()){a.on({scrollend:this.onScrollEnd,scope:this})}},onStoreBeforeLoad:function(a){this.addLoadMoreCmp();if(a.getCount()===0){this.getLoadMoreCmp().hide()}}});
;
Ext.define("ux.plugin.RCarousel",{extend:"Ext.Carousel",xtype:"RCarousel",id:"RCarousel",requires:["Ext.carousel.Carousel"],config:{direction:"horizontal",showAnimation:"slideIn",hideAnimation:"slideOut",cls:"i-carousel-indicator-dark",listeners:{},},});
;
Ext.define("ux.BMap",{alternateClassName:"bMap",extend:"Ext.Container",xtype:"bMap",requires:["Ext.util.Geolocation"],config:{map:null,mapOptions:{},center:"苏州",markerTap:false,locate:null,geo:null,lng:"111",lat:null,store:null,data:null,ak:null,nearData:null},initialize:function(){this.callParent();this.on({painted:"initMap",scope:this})},storeEventHooks:{load:"onLoad"},updateData:function(c){var b=this,a=b.getStore();if(!a){this.setStore(Ext.create("Ext.data.Store",{data:c,autoDestroy:true}))}else{a.add(c)}},applyStore:function(a){var b=this,c=Ext.apply({},b.storeEventHooks,{scope:b});if(a){a=Ext.data.StoreManager.lookup(a);a.onAfter(c)}return a},updateStore:function(a,c){var b=this,d=Ext.apply({},b.storeEventHooks,{scope:b});if(c&&Ext.isObject(c)&&c.isStore){c.un(d);if(c.getAutoDestroy()){c.destroy()}}if(a.getCount()){b.on({showMap:function(){b.onLoad(a)}})}},onLoad:function(b){var d=this,e=d.getMap(),a,c;e.clearOverlays();b.each(function(f,h,i){c=f.getData();if(c.lng&&c.lat){a=new BMap.Marker(new BMap.Point(c.lng,c.lat));a.options={};for(var g in c){if(g!="lng"&&g!="lat"){a.options[g]=c[g]}}if(d.getMarkerTap()){a.addEventListener("click",function(j,k){d.fireAction("tapMarker",[d,this],"onTapMarker")})}e.addOverlay(a)}})},initMap:function(){var d=this,f=d.getMap();if(!f){var c=d.getMapOptions(),f=new BMap.Map(d.getId()),b=d.getCenter(),a;if(Ext.isString(b)){a=b}else{if(Ext.isObject(b)){a=new BMap.Point(b.lng,b.lat)}}point1=new BMap.Point(d.getLng(),d.getLat());var e=new BMap.Marker(point1);f.addOverlay(e);f.centerAndZoom(point1,14);f.addControl(new BMap.ZoomControl());if(c.locate){f.addControl(d.getLocateControl())}d.setMap(f);if(c.markers){d.setData(c.markers)}}},getLocateControl:function(){var a=new BMap.Control();a.defaultAnchor=BMAP_ANCHOR_BOTTOM_LEFT;a.defaultOffset=new BMap.Size(10,70);a.initialize=function(d){var c=document.createElement("div");c.className="BMap_ZoomCtrl zoom_btn locateControl";var b=document.createElement("div");b.className="location";c.appendChild(b);d.getContainer().appendChild(c);return c};this.element.on({tap:"onLocate",delegate:"div.locateControl",scope:this});return a},onLocate:function(b){var a=b.getTarget("div.location",null,true);this.setLocate(a);this.setGeo(true)},applyGeo:function(a){return Ext.factory(a,Ext.util.Geolocation,this.getGeo())},updateGeo:function(b,a){var c={locationupdate:"onGeoUpdate",locationerror:"onGeoError",scope:this};if(a){a.un(c)}if(b){b.on(c);b.updateLocation()}},onGeoUpdate:function(b){var a=this,c=a.getAk();if(c){Ext.data.JsonP.request({url:"http://api.map.baidu.com/geoconv/v1/",params:{coords:b.getLongitude()+","+b.getLatitude(),from:1,to:5,ak:c},scope:this,callbackKey:"callback",success:function(h){if(h){var g=a.getMapOptions(),e=new BMap.Map(a.getId()),d=a.getCenter(),m;m=new BMap.Point(h.result[0].x,h.result[0].y);point1=new BMap.Point(h.result[0].x-0.001,h.result[0].y-0.001);e.centerAndZoom(m,18);e.addControl(new BMap.ZoomControl());var l=new BMap.MapTypeControl({anchor:BMAP_ANCHOR_TOP_RIGHT,mapTypes:[BMAP_NORMAL_MAP,BMAP_SATELLITE_MAP],offset:new BMap.Size(10,50)});e.addControl(l);if(g.locate){e.addControl(a.getLocateControl())}var n=new BMap.Icon(config.webSite+"/Upload/Mobile/bullet-blue.png",new BMap.Size(18,18));var i=new BMap.Marker(m,{icon:n});e.addOverlay(i);var k=new BMap.Icon("http://api.map.baidu.com/mapCard/img/location.gif",new BMap.Size(20,25));var f=new BMap.Marker(point1);e.addOverlay(f);a.setMap(e);var j=new BMap.LocalSearch(e);j.searchInBounds("公司",e.getBounds());j.setSearchCompleteCallback(function(o){var q=o.getCurrentNumPois();Ext.regModel("NearCompany",{fields:[{name:"value",type:"string"},{name:"text",type:"string"}]});nearCompanyStore=new Ext.data.Store();for(var p=0;p<q;p++){var r=o.getPoi(p);nearCompanyStore.add(new NearCompany({value:r.title,text:r.title}))}});a.setGeo(false)}},failure:function(e,d){util.showMessage(e.responseText)}})}else{a.addMyPoint(b.getLongitude(),b.getLatitude())}},addMyPoint:function(b,g){var e=this,f=e.getMap(),d=new BMap.Icon("resources/icons/markers1.png",new BMap.Size(20,25),{imageOffset:new BMap.Size(0,0)}),a=new BMap.Point(b,g),c=new BMap.Marker(a,{icon:d});f.addOverlay(c);f.setCenter(a);e.unLocate()},onGeoError:function(){this.unLocate();this.fireEvent("geoError",this)},unLocate:function(){var a=this.getLocate();if(a){a.removeCls("locationGif")}},search:function(b,d){var c=this.getMap();!d&&c.clearOverlays();var a=new BMap.LocalSearch(c,{renderOptions:{map:c,autoViewport:true}});a.search(b)},searchNearby:function(b,e,d){var c=this.getMap();!d&&c.clearOverlays();var a=new BMap.LocalSearch(c,{renderOptions:{map:c,autoViewport:true}});a.searchNearby(b,e)},setMapCenter:function(a,c){var b=this.getMap();if(b){b.setCenter(new BMap.Point(a,c))}}});
;
Ext.define("ux.Countdown",{alternateClassName:"countdown",extend:"Ext.Component",xtype:"countdown",config:{baseCls:Ext.baseCSSPrefix+"label",format:"Y-m-d H:i:s",value:null},initialize:function(){this.callParent();this.on({hide:"stop",scope:this})},stop:function(){console.log("停止计时");clearInterval(this.task);this.isStart=false},start:function(){var a=this;if(!a.isStart&&a.time){console.log("开始计时");a.isStart=true;a.task=setInterval(function(){a.timing(a)},1000);a.timing(a)}},updateValue:function(c,a){var b=this;if(c){c=Ext.Date.parse(c,b.getFormat());if(c){b.time=c;b.start()}}},timing:function(g){if(!g.time){clearInterval(g.task);console.log("停止计时")}else{var f=new Date(),e=g.time-f,b=Math.floor(e/(1000*60*60*24)),a=Math.floor(e/(1000*60*60))%24,h=Math.floor(e/(1000*60))%60,d=Math.floor(e/1000)%60,c;if(e>0){console.log("正在计时");if(b>0){c=util.format("剩余{0}天{1}小时{2}分{3}秒",b,a,h,d)}else{if(a>0){c=util.format("剩余{0}小时{1}分{2}秒",a,h,d)}else{if(h>0){c=util.format("剩余{0}分{1}秒",h,d)}else{if(d>=0){c=util.format("剩余{0}秒",d)}}}}g.setHtml(c)}else{console.log("计时结束");g.setHtml("已结束");g.fireEvent("end",g);clearInterval(g.task)}}}});
;
Ext.define("ux.CSS",(function(){var c=window.document,b=c.getElementsByTagName("head")[0],a;return{alternateClassName:"CSS",singleton:true,path:"resources/css",appCSSId:"default",constructor:function(){var d=this.path.split("/");d=Ext.Array.clean(d);this.path=d.join("/");a=this.getAppStyleSheet();if(a){a.id=this.appCSSId}},getAppStyleSheet:function(){var d;if(a){return a}d=Ext.DomQuery.select("link[rel=stylesheet]")[0];return d},getStyleSheet:function(e){var d=Ext.DomQuery.select("link[id="+e+"]");return d},createStyleSheet:function(){},removeStyleSheet:function(e){var d=Ext.DomQuery.select("link[id="+e+"]");if(d){b.removeChild(d)}},cleanStyleSheets:function(){var e=this,d=Ext.DomQuery.select("link[rel=stylesheet]");Ext.each(d,function(f){if(f.id!==e.appCSSId){b.removeChild(f)}})},addStyleSheet:function(e){var f=c.createElement("link"),d=this.path+"/"+e+".css";f.setAttribute("rel","stylesheet");f.setAttribute("type","text/css");f.setAttribute("id",e);f.setAttribute("href",d);c.getElementsByTagName("head")[0].appendChild(f)},swapStyleSheet:function(e){var f=c.createElement("link"),d=this.path+"/"+e+".css";this.cleanStyleSheets();f.setAttribute("rel","stylesheet");f.setAttribute("type","text/css");f.setAttribute("id",e);f.setAttribute("href",d);c.getElementsByTagName("head")[0].appendChild(f)}}}()));
;
Ext.define("ux.DateTime",{extend:"Ext.picker.Picker",xtype:"datetimepicker",alternateClassName:"ux.DateTimePicker",requires:["Ext.DateExtras"],config:{yearFrom:1980,yearTo:new Date().getFullYear()+10,monthText:(Ext.os.deviceType.toLowerCase()=="phone")?"M":"Month",dayText:(Ext.os.deviceType.toLowerCase()=="phone")?"j":"Day",yearText:(Ext.os.deviceType.toLowerCase()=="phone")?"Y":"Year",hourText:(Ext.os.deviceType.toLowerCase()=="phone")?"H":"Hour",minuteText:(Ext.os.deviceType.toLowerCase()=="phone")?"i":"Minute",ampmText:(Ext.os.deviceType.toLowerCase()=="phone")?"A":"AM/PM",slotOrder:["year","month","day","hour","minute","ampm"],minuteInterval:15,ampm:false,},initialize:function(){this.callParent();this.on({scope:this,delegate:"> slot",slotpick:this.onSlotPick})},setValue:function(b,a){if(Ext.isDate(b)){ampm="AM";currentHours=hour=b.getHours();if(this.getAmpm()){if(currentHours>12){ampm="PM";hour-=12}else{if(currentHours==12){ampm="PM"}else{if(currentHours==0){hour=12}}}}b={day:b.getDate(),month:b.getMonth()+1,year:b.getFullYear(),hour:hour,minute:b.getMinutes(),ampm:ampm}}this.callParent([b,a])},getValue:function(){var m={},a,k,d,c,h=this.getItems().items,g=h.length,o,e;for(e=0;e<g;e++){o=h[e];if(o instanceof Ext.picker.Slot){m[o.getName()]=o.getValue()}}a=this.getDaysInMonth(m.month,m.year);k=Math.min(m.day,a),d=m.hour,c=m.minute;var j=(isNaN(m.year))?new Date().getFullYear():m.year,b=(isNaN(m.month))?(new Date().getMonth()):(m.month-1),n=(isNaN(k))?(new Date().getDate()):k,l=(isNaN(d))?new Date().getHours():d,f=(isNaN(c))?new Date().getMinutes():c;if(m.ampm&&m.ampm=="PM"&&l<12){l=l+12}if(m.ampm&&m.ampm=="AM"&&l==12){l=0}return new Date(j,b,n,l,f)},updateYearFrom:function(){if(this.initialized){this.createSlots()}},updateYearTo:function(){if(this.initialized){this.createSlots()}},updateMonthText:function(a,b){var f=this.getInnerItems,e=f.length,d,c;if(this.initialized){for(c=0;c<e;c++){d=f[c];if((typeof d.title=="string"&&d.title==b)||(d.title.html==b)){d.setTitle(a)}}}},updateDayText:function(a,c){var f=this.getInnerItems,e=f.length,d,b;if(this.initialized){for(b=0;b<e;b++){d=f[b];if((typeof d.title=="string"&&d.title==c)||(d.title.html==c)){d.setTitle(a)}}}},updateYearText:function(e){var d=this.getInnerItems,c=d.length,b,a;if(this.initialized){for(a=0;a<c;a++){b=d[a];if(b.title==this.yearText){b.setTitle(e)}}}},constructor:function(){this.callParent(arguments);this.createSlots()},createSlots:function(){var r=this,f=this.getSlotOrder(),c=r.getYearFrom(),b=r.getYearTo(),m=[],d=[],g=[],p=[],n=[],l=[],j,q,o,a;if(!this.getAmpm()){var e=f.indexOf("ampm");if(e>=0){f.splice(e)}}if(c>b){q=c;c=b;b=q}for(o=c;o<=b;o++){m.push({text:o,value:o})}a=this.getDaysInMonth(1,new Date().getFullYear());for(o=0;o<a;o++){d.push({text:o+1,value:o+1})}for(o=0,j=Ext.Date.monthNames.length;o<j;o++){g.push({text:(Ext.os.deviceType.toLowerCase()=="phone")?Ext.Date.monthNames[o].substring(0,3):Ext.Date.monthNames[o],value:o+1})}var s=(this.getAmpm())?12:23;var h=(this.getAmpm())?1:0;for(o=h;o<=s;o++){p.push({text:this.pad2(o),value:o})}for(o=0;o<60;o+=this.getMinuteInterval()){n.push({text:this.pad2(o),value:o})}l.push({text:"AM",value:"AM"},{text:"PM",value:"PM"});var k=[];f.forEach(function(t){k.push(this.createSlot(t,d,g,m,p,n,l))},this);r.setSlots(k)},createSlot:function(d,g,a,f,b,e,c){switch(d){case"year":return{name:"year",align:(Ext.os.deviceType.toLowerCase()=="phone")?"left":"center",data:f,title:this.getYearText(),flex:(Ext.os.deviceType.toLowerCase()=="phone")?1.3:3};case"month":return{name:d,align:(Ext.os.deviceType.toLowerCase()=="phone")?"left":"right",data:a,title:this.getMonthText(),flex:(Ext.os.deviceType.toLowerCase()=="phone")?0.9:2};case"day":return{name:"day",align:(Ext.os.deviceType.toLowerCase()=="phone")?"left":"center",data:g,title:this.getDayText(),flex:(Ext.os.deviceType.toLowerCase()=="phone")?0.9:2};case"hour":return{name:"hour",align:(Ext.os.deviceType.toLowerCase()=="phone")?"left":"center",data:b,title:this.getHourText(),flex:(Ext.os.deviceType.toLowerCase()=="phone")?0.9:2};case"minute":return{name:"minute",align:(Ext.os.deviceType.toLowerCase()=="phone")?"left":"center",data:e,title:this.getMinuteText(),flex:(Ext.os.deviceType.toLowerCase()=="phone")?0.9:2};case"ampm":return{name:"ampm",align:(Ext.os.deviceType.toLowerCase()=="phone")?"left":"center",data:c,title:this.getAmpmText(),flex:(Ext.os.deviceType.toLowerCase()=="phone")?1.1:2}}},onSlotPick:function(b,c,e,d){var a=b.getStore().getAt(b.selectedIndex).get(b.getValueField());b.setValue(a);if(b.getName()==="month"||b.getName()==="year"){this.repopulateDaySlot()}},repopulateDaySlot:function(){var e=this.getDaySlot(),d=[],c=this.getSlotByName("month").getValue(),b=this.getSlotByName("year").getValue(),a;a=this.getDaysInMonth(c,b);for(i=0;i<a;i++){d.push({text:i+1,value:i+1})}if(e.getData().length==d.length){return}e.setData(d)},getSlotByName:function(a){return this.down("pickerslot[name="+a+"]")},getDaySlot:function(){return this.getSlotByName("day")},getDaysInMonth:function(c,b){var a=[31,28,31,30,31,30,31,31,30,31,30,31];return c==2&&this.isLeapYear(b)?29:a[c-1]},isLeapYear:function(a){return !!((a&3)===0&&(a%100||(a%400===0&&a)))},pad2:function(a){return(a<10?"0":"")+a}});
;
Ext.define("ux.DateTimePicker",{extend:"Ext.field.Text",alternateClassName:"Ext.form.DateTimePicker",xtype:"datetimepickerfield",requires:["ux.DateTime","Ext.DateExtras"],config:{ui:"select",picker:true,clearIcon:false,destroyPickerOnHide:false,dateTimeFormat:"Y/m/d H:i",component:{useMask:true}},initialize:function(){this.callParent();this.getComponent().on({scope:this,masktap:"onMaskTap"});this.getComponent().input.dom.disabled=true},syncEmptyCls:Ext.emptyFn,applyValue:function(a){if(!Ext.isDate(a)&&!Ext.isObject(a)){a=null}if(Ext.isObject(a)){a=new Date(a.year,a.month-1,a.day,a.hour,a.minute)}return a},updateValue:function(b){var a=this._picker;if(a&&a.isPicker){a.setValue(b)}if(b!==null){this.getComponent().setValue(Ext.Date.format(b,this.getDateTimeFormat()||Ext.util.Format.defaultDateFormat))}else{this.getComponent().setValue("")}if(this._picker&&this._picker instanceof ux.DateTime){this._picker.setValue(b)}},updateDateFormat:function(c,a){var b=this.getValue();if(c!=a&&Ext.isDate(b)&&this._picker&&this._picker instanceof ux.DateTime){this.getComponent().setValue(Ext.Date.format(b,c||Ext.util.Format.defaultDateFormat))}},getValue:function(){if(this._picker&&this._picker instanceof ux.DateTime){return this._picker.getValue()}return this._value},getFormattedValue:function(b){var a=this.getValue();console.log(this.getDateTimeFormat(),"format");return(Ext.isDate(a))?Ext.Date.format(a,b||this.getDateTimeFormat()||Ext.util.Format.defaultDateFormat):a},applyPicker:function(b,a){if(a&&a.isPicker){b=a.setConfig(b)}return b},getPicker:function(){var a=this._picker,b=this.getValue();if(a&&!a.isPicker){a=Ext.factory(a,ux.DateTime);a.on({scope:this,cancel:"onPickerHide",change:"onPickerChange",hide:"onPickerHide"});if(b!==null){a.setValue(b)}Ext.Viewport.add(a);this._picker=a}return a},onMaskTap:function(){if(this.getDisabled()){return false}if(this.getReadOnly()){return false}this.getPicker().show();return false},onPickerCancel:function(b,a){this._picker=this._picker.config;b.destroy();return true},onPickerChange:function(a,c){var b=this;b.setValue(c);b.fireEvent("change",b,b.getValue())},onPickerHide:function(){var a=this.getPicker();if(this.getDestroyPickerOnHide()&&a){a.destroy();this._picker=true}},reset:function(){this.setValue(this.originalValue)},destroy:function(){var a=this.getPicker();if(a&&a.isPicker){a.destroy()}this.callParent(arguments)}},function(){this.override({getValue:function(a){if(a){Ext.Logger.deprecate("format argument of the getValue method is deprecated, please use getFormattedValue instead",this);return this.getFormattedValue(a)}return this.callOverridden()}});Ext.deprecateMethod(this,"getDatePicker","getPicker")});
;
Ext.define("ux.Fileup",{extend:"Ext.Button",xtype:"fileupload",requires:["Ext.MessageBox"],template:[{tag:"span",reference:"badgeElement",hidden:true},{tag:"span",className:Ext.baseCSSPrefix+"button-icon",reference:"iconElement",hidden:true},{tag:"span",reference:"textElement",hidden:true},{tag:"div",className:Ext.baseCSSPrefix+"loading-spinner",reference:"loadingElement",hidden:true,children:[{tag:"span",className:Ext.baseCSSPrefix+"loading-top"},{tag:"span",className:Ext.baseCSSPrefix+"loading-right"},{tag:"span",className:Ext.baseCSSPrefix+"loading-bottom"},{tag:"span",className:Ext.baseCSSPrefix+"loading-left"}]},{tag:"form",reference:"formElement",hidden:false,children:[{tag:"input",reference:"fileElement",type:"file",name:"userfile",tabindex:-1,hidden:false,style:"opacity:0;position:absolute;top:-3px;right:-3px;bottom:-3px;left:-3px;z-index:16777270;"}]}],defaultStates:{browse:{text:"拍照或选取现有图片",cls:"i-button",ui:"filebrowse"},ready:{text:"Upload",cls:Ext.baseCSSPrefix+"fileup-ready",ui:"fileready"},uploading:{text:"Uploading",cls:Ext.baseCSSPrefix+"fileup-uploading",ui:"fileupload",loading:true}},currentState:null,config:{cls:Ext.baseCSSPrefix+"fileup",badgeCls:Ext.baseCSSPrefix+"fileup-badge",name:"userfile",autoUpload:false,states:true,text:"Browse",loadAsDataUrl:false,url:""},applyStates:function(a){var b=this;if(a){if(Ext.isObject(a)){return Ext.merge({},b.defaultStates,a)}else{return b.defaultStates}}else{return b.defaultStates}},initialize:function(){var a=this;a.callParent();a.fileElement.dom.onchange=function(){a.onChanged.apply(a,arguments)};a.on({scope:a,buffer:250,tap:a.onButtonTap});a.changeState("browse")},onButtonTap:function(){var b=this;switch(b.currentState){case"ready":b.changeState("uploading");var a=b.fileElement.dom.files[0];if(a){fileArray[fileCount]=a}if(!b.getLoadAsDataUrl()){b.fireEvent("uploadstart",a);b.doUpload(a)}else{b.doLoad(a)}break}},onChanged:function(b){var a=this;if(b.target.files.length>0){a.fireAction("ready",[b.target.files[0]],function(){a.changeState("ready")},a)}else{}},changeState:function(c){var b=this;var a=b.getStates();if(Ext.isDefined(a[c])){if(a[c].text){b.setText(a[c].text)}else{b.setText("")}if(a[c].cls){b.setCls(a[c].cls)}else{b.setCls("")}if(a[c].ui){b.setUi(a[c].ui)}else{b.setUi("normal")}if(a[c].loading){b.loadingElement.show()}else{b.loadingElement.hide()}switch(c){case"browse":b.currentState="browse";b.reset();break;case"ready":b.currentState="ready";b.fileElement.hide();if(b.getAutoUpload()){b.onButtonTap()}break;case"uploading":b.currentState="uploading";break}}else{Ext.Logger.warn('Config for FileUp state "'+c+'" not found!')}},doLoad:function(b){var c=this;var a=new FileReader();a.onerror=function(f){var d;switch(f.target.error.code){case f.target.error.NOT_FOUND_ERR:d="File Not Found";break;case f.target.error.NOT_READABLE_ERR:d="File is not readable";break;case f.target.error.ABORT_ERR:break;default:d="Can not read file"}c.fireEvent("loadfailure",d,this,f)};a.onload=function(d){c.fireEvent("loadsuccess",this.result,this,d);c.changeState("browse")};a.readAsDataURL(b)},doUpload:function(b){var d=this;var a=new XMLHttpRequest();if(a.upload&&a.upload.addEventListener){a.upload.onprogress=function(g){if(g.lengthComputable){var f=(g.loaded/g.total)*100;d.setBadgeText(f.toFixed(0)+"%")}};a.onreadystatechange=function(g){if(this.readyState==4){if(this.status==200){var f=Ext.decode(this.responseText,true);if(f&&f.success){d.fireEvent("success",f,this,g)}else{if(f&&f.message){d.fireEvent("failure",f.message,f,this,g)}else{d.fireEvent("failure","Unknown error",f,this,g)}}}else{d.fireEvent("failure",this.status+" "+this.statusText,f,this,g)}d.changeState("browse")}};a.upload.onerror=function(f){d.fireEvent("failure",this.status+" "+this.statusText,{},this,f)}}var c=new FormData();c.append(d.getName(),b);a.open("POST",d.getUrl());a.send(c)},reset:function(){var a=this;a.setBadgeText(null);a.formElement.dom.reset();a.fileElement.show()}});
;
Ext.define("ux.NavigationBar",{extend:"Ext.TitleBar",requires:["Ext.Button","Ext.Spacer"],config:{baseCls:Ext.baseCSSPrefix+"toolbar",cls:Ext.baseCSSPrefix+"navigation-bar",title:null,defaultType:"button",layout:{type:"hbox"},backButton:{align:"left",ui:"back",hidden:true},tmpItems:null,tmpCls:null,backHide:true},constructor:function(a){a=a||{};if(!a.items){a.items=[]}this.callParent([a])},updateView:function(b,a){this.setTitle(b.title||"");this.setBackHide(b.backHide||a.length==1);b.navigationBar=b.navigationBar||{};this.setTmpItems(b.navigationBar.tmpItems);this.setTmpCls(b.navigationBar.tmpCls)},applyBackButton:function(a){return Ext.factory(a,Ext.Button,this.getBackButton())},updateBackButton:function(a,b){if(b){this.remove(b)}if(a){this.add(a);a.on({scope:this,tap:this.onBackButtonTap})}},updateBackHide:function(b,c){var a=this.getBackButton();if(b){a.hide()}else{a.show()}},applyTmpItems:function(b){if(!b){return false}var e=this,a=[],c,d;b=Ext.Array.from(b);for(c=0,d=b.length;c<d;c++){a.push(e.factoryItem(b[c]))}return a},updateTmpItems:function(b,d){if(d){var a,c;for(a=0,c=d.length;a<c;a++){this.remove(d[a])}}if(b){this.add(b)}},updateTmpCls:function(a,b){if(b){this.removeCls(b)}if(a){this.addCls(a)}},onBackButtonTap:function(){this.fireEvent("back",this)}});
;
Ext.define("ux.NavigationView",{extend:"Ext.Container",xtype:"uNavigationView",requires:["ux.NavigationBar"],config:{layout:{type:"card",animation:{duration:300,easing:"ease-out",type:"slide",direction:"left"}},navigationBar:{docked:"top",cls:"navigationBar"},otherMenu:null,clear:null},initConfig:function(){this.viewStack=[];this.viewStatus={};this.callParent(arguments)},initialize:function(){var c=this,a=c.getNavigationBar();a.on({back:c.onBackButtonTap,scope:c});c.relayEvents(a,"rightbuttontap");c.relayEvents(c,{add:"push",remove:"pop"});var b=c.getLayout();if(b&&!b.isCard){Ext.Logger.error("CardPanel中layout的布局只能是card布局")}},applyOtherMenu:function(a){var b=this.otherMenu;if(b){if(!a){b.hide();return b}if(b.getItemId()==a){b.show();return b}}this.otherMenu=Ext.create(a,{itemId:a});return this.otherMenu},updateOtherMenu:function(a,b){if(b){this.remove(b)}if(a){this.add(a)}},applyNavigationBar:function(a){return Ext.factory(a,"ux.NavigationBar",this.getNavigationBar())},updateNavigationBar:function(a,b){if(b){this.remove(b,true)}if(a){this.add(a)}},updateClear:function(a,c){var b=this.getLayout().getAnimation();if(c){b.un({scope:this,animationend:"clearItem"})}if(a){b.on({scope:this,animationend:"clearItem"})}},push:function(e,d){var c=this,a=c.getActiveItem(),b=a&&(a.config.xtype||a.getItemId());c.tempConfig=d;if(!c.viewStatus[e]){d=d||{};d.itemId=e;a=Ext.create(e,d);c.add(a)}else{if(b!=e){c.setActiveItem(e)}else{if(d){c.onActivate(a)}}}},pop:function(a){if(this.beforePop(a)){return this.doPop()}},popAndPush:function(b,a){this.viewStack.pop();this.doPop(b);if(b){this.push(b,a)}},beforePop:function(f){var e=this,g=e.getInnerItems();if(Ext.isString(f)||Ext.isObject(f)){var d=g.length-1,a;for(a=d;a>=0;a--){if((Ext.isString(f)&&Ext.ComponentQuery.is(g[a],f))||(Ext.isObject(f)&&f==g[a])){f=d-a;break}}if(!Ext.isNumber(f)){return false}}var c=g.length,b;if(!Ext.isNumber(f)||f<1){f=1}f=Math.min(f,c-1);if(f){this.viewStackPop(f);b=g.splice(-f,f-1);for(a=0;a<b.length;a++){this.remove(b[a])}return true}return false},doPop:function(b){var c=this,d=this.getInnerItems(),a=d[d.length-1];if(b){this.isPopAndPush=true;a.hide()}c.remove(a);return this.getActiveItem()},reset:function(){return this.pop(this.getInnerItems().length)},clearItem:function(){index=this.getClear()-1;var d=this,e=this.getInnerItems(),c=e.length-1,a,b;for(b=c;b>index;b--){a=e[b];if(a.isHidden()){d.remove(a,true)}}},viewStackPop:function(b){for(var a=0;a<b;a++){this.viewStack.pop()}},onActivate:function(b){if(this.isPopAndPush){this.isPopAndPush=false;return}if(this.tempConfig){b.setConfig(this.tempConfig);delete this.tempConfig}var c=b.config;var a=c.clear>-1;if(a){this.viewStack.splice(c.clear,this.viewStack.length);xtype=b.config.xtype||b.getItemId();if(xtype!=this.viewStack[0]){this.viewStack.push(xtype)}}this.setClear(a);this.getNavigationBar().updateView(c,this.viewStack);this.setOtherMenu(c.otherMenu)},onDestroy:function(a){this.viewStatus[a.config.xtype||a.getItemId()]=false},doResetActiveItem:function(d){var a=this,c=a.getInnerItems(),b=a.getLayout().getAnimation();if(d>0){if(b&&b.isAnimation){b.setReverse(true)}a.setActiveItem(d-1)}},doRemove:function(){var a=this.getLayout().getAnimation();if(a&&a.isAnimation){a.setReverse(false)}this.callParent(arguments)},onItemAdd:function(b,a){if(b.isInnerItem()){var c=b.config.xtype||b.getItemId();this.viewStatus[c]=true;this.viewStack.push(c);b.on({scope:this,activate:"onActivate",destroy:"onDestroy"})}this.doItemLayoutAdd(b,a);if(!this.isItemsInitializing&&b.isInnerItem()){this.setActiveItem(b)}if(this.initialized){this.fireEvent("add",this,b,a)}},onBackButtonTap:function(){this.pop();this.fireEvent("back",this)}});
;
Ext.define("ux.PageTab",{extend:"Ext.TabPanel",xtype:"pageTab",config:{cls:"pageTab",moveNum:41,allowOverflow:false,rightBtn:{iconMask:true,iconCls:"tabRight",name:"move",action:1,docked:"right"},leftBtn:{iconCls:"tabLeft",iconMask:true,action:-1,name:"move",docked:"left"},tabBar:{cls:"pageTabBar",scrollable:{direction:"horizontal",indicators:false}}},applyRightBtn:function(a){return Ext.factory(a,Ext.Button,this.getRightBtn())},updateRightBtn:function(a,b){this.updateMoveBtn(a,b)},applyLeftBtn:function(a){return Ext.factory(a,Ext.Button,this.getLeftBtn())},updateLeftBtn:function(a,b){this.updateMoveBtn(a,b)},updateMoveBtn:function(a,b){if(b){this.getTabBar().remove(b)}if(a){this.getTabBar().add(a);a.on({scope:this,tap:this.onTabMove})}},onTabMove:function(c){var f=this.getActiveItem(),b=this.getAllowOverflow(),e=this.getInnerItems(),g=e.length-1,a=Ext.Array.indexOf(e,f),d=a+c.config.action;if(d<0){if(!b){return}d=g}else{if(d>g){if(!b){return}d=0}}this.setActiveItem(d);this.setScroll(d)},selectView:function(f){var d=this,e=d.getInnerItems(),a,c,b;for(a=0,c=e.length;a<c;a++){b=e[a];if(b.getItemId()==f){d.setActiveItem(b);d.setScroll(a);break}}},setScroll:function(a){var b=this.getMoveNum();if(b&&b>0){var c=this.getTabBar().getScrollable().getScroller();c.scrollTo(a*b,0)}}});
;
Ext.define("ux.PathMenu",{mixins:["Ext.mixin.Observable"],xtype:"pathmenu",requires:["Ext.Button","Ext.util.DelayedTask"],config:{cls:"x-ux-pathmenu",top:null,bottom:null,right:null,left:null,height:40,width:40,items:[],radius:150,menuButtonDefault:{iconCls:"add",ui:"pathmenu",iconMask:true,isOpen:false,pathButtonType:"menu",cls:"menubutton"},menuItemDefault:{iconMask:true,ui:"pathmenu",isActive:false,pathButtonType:"menuitem"},menuItems:null,menuTrigger:null},constructor:function(c){this.initConfig(c);var d=this,b=[],a={xtype:"button",top:this.getTop(),bottom:this.getBottom(),right:this.getRight(),left:this.getLeft(),height:this.getHeight(),width:this.getWidth()},e=this.getMenuButtonDefault(),f=this.getMenuItemDefault();Ext.each(c.items,function(h,g){var i=Ext.apply(h,f,a);Ext.apply(i,{handler:d.onMenuItemButtonTap,scope:d});b.push(h);delete (h)},this);b.push(Ext.apply({handler:d.onMenuButtonTap,scope:d},e,a));Ext.Viewport.add(b)},onMenuItemButtonTap:function(b){var c=this,a=Ext.ComponentQuery.query("button[pathButtonType=menu]")[0];b.addCls("tapped");c.close(a);b.fireEvent("itemtap",c,b)},onMenuButtonTap:function(a){if(!a.isOpen){this.open(a)}else{this.close(a)}},open:function(d){var c=Ext.ComponentQuery.query("button[pathButtonType=menuitem]"),b=d.getBottom(),f=d.getLeft(),a=150,e=c.length-1;angle=90/e;d.replaceCls("close","open");Ext.each(c,function(i,h){i.addCls("menuitembutton");i.replaceCls("close","open");var k=(90-(angle*(e-h))),j=Math.PI/180,l=j*k,g=Math.round(Math.cos(l)*a),m=Math.round(Math.sin(l)*a);i.setLeft(f+g);i.setBottom(b+m)});d.isOpen=true},close:function(b){var a=Ext.ComponentQuery.query("button[pathButtonType=menuitem]");b.replaceCls("open","close");Ext.each(a,function(e,d){if(e.getCls().indexOf("tapped")===-1){e.replaceCls("open","close");e.setLeft(10);e.setBottom(10)}else{var c=Ext.create("Ext.util.DelayedTask",function(){e.removeCls("menuitembutton");e.setLeft(10);e.setBottom(10);e.removeCls("tapped")});c.delay(900)}});b.isOpen=false}});
;
Ext.define("ux.Rating",{xtype:"fieldRating",extend:"Ext.field.Field",config:{baseCls:Ext.baseCSSPrefix+"field x-rating",value:0,editable:true,name:"rating",clearIcon:false,component:{hidden:true,xtype:"input",type:"text",useMask:true},},getElementConfig:function(){var a=Ext.baseCSSPrefix;return{reference:"element",className:"x-container",children:[{reference:"label",cls:a+"form-label",children:[{reference:"labelspan",tag:"span"}]},{reference:"innerElement",cls:a+"component-outer",html:'&nbsp;<div class="starContainer"><div class="left"></div><div class="x-button x-button-action star star1"></div><div class="center"></div><div class="x-button x-button-action star star2"></div><div class="center"></div><div class="x-button x-button-action star star3"></div><div class="center"></div><div class="x-button x-button-action star star4"></div><div class="center"></div><div class="x-button x-button-action star star5"></div><div class="right"></div></div><div class="starFakeContainer"></div>',}]}},initialize:function(){var a=this;a.callParent();a.on("painted",function(){a.starFakeContainer=a.innerElement.down(".starFakeContainer");a.star1=a.innerElement.down(".star1");a.star2=a.innerElement.down(".star2");a.star3=a.innerElement.down(".star3");a.star4=a.innerElement.down(".star4");a.star5=a.innerElement.down(".star5");var b=a.getValue();a.orignalValue=b;a.activateStars(b);a.setEditable(a.getEditable())})},applyEditable:function(a){var b=this;if(!b.starFakeContainer){return a}if(a){b.starFakeContainer.on({touchstart:b.onTouchStartMove,touchmove:b.onTouchStartMove,touchend:b.onTouchEnd,scope:b})}else{b.starFakeContainer.un({touchstart:b.onTouchStartMove,touchmove:b.onTouchStartMove,touchend:b.onTouchEnd,scope:b})}return a},applyValue:function(b){var a=this;if(b<0){b=0}else{if(b>5){b=5}}a.activateStars(b);return b},activateStars:function(b){if(!this["star1"]){return}for(var a=1;a<=5;a++){this["star"+a].removeCls("active")}for(var a=1;a<=b;a++){this["star"+a].addCls("active")}},buildRating:function(d){var b=this.starFakeContainer.getWidth();if(d>=b){d=b}else{if(d<=0){d=0}}d=d/b*100;var c=((b/12)/b*100);var a=0;if(d>=(c*9)){a=5}else{if(d>=(c*7)){a=4}else{if(d>=(c*5)){a=3}else{if(d>=(c*3)){a=2}else{if(d>=c){a=1}}}}}this.setValue(a);return d},onTouchStartMove:function(b){var c=this;var d=c.innerElement.dom.offsetLeft;if(d){c.buildRating(b.pageX-d)}},onTouchEnd:function(b){var c=this;var e=c.innerElement.dom.offsetLeft;if(e){c.buildRating(b.pageX-e)}var d=c.getValue();if(c.orignalValue!=d){c.orignalValue=d;c.fireEvent("change",this,d,c.orignalValue)}}});
;
Ext.define("ux.SimpleList",{alternateClassName:"simpleList",extend:"Ext.List",xtype:"simpleList",config:{editCls:"simpleList",editId:"",dic:"",onItemDisclosure:false,isSimple:false,ckId:"id",defSimpleType:0,simpleToolBar:{docked:"bottom",defTitle:"删除",items:[{xtype:"button",text:"全选",align:"left",isSimple:true,listeners:{tap:function(a){var b=a.up("list");if(a.getText()=="全选"){this.setText("取消全选");b.selectAll();b.selectAllRows()}else{this.setText("全选");b.deselectAll();b.unselectAllRows()}this.isSimple=!this.isSimple}}},{cls:"moreButton",xtype:"button",text:"取消",align:"right",listeners:{tap:function(a){var b=a.up("list");b.endSimple(b)}}},{cls:"moreButton",xtype:"button",text:"确定",align:"right",listeners:{tap:function(c){var f=c.up("list");var a=f.getSelection();var d=[];for(var b=0,e;e=a[b];b++){d.push(e.data[f.config.ckId])}if(d.length>0){f.fireEvent("simpleSuccess",f,a,d,f.config.simpleType);f.endSimple(f)}else{util.showMessage("请先选择记录后再确定，否则按取消！",true)}}}}]},listeners:{painted:function(b,a){dic=new Dictionary()},itemtap:function(c,b,f,a,d){if(this.config.isSimple){d.stopEvent();var g=this.listItems[b].getDisclosure();if(g._hidden==true){g.show();dic.Add(b,b)}else{g.hide();dic.Remove(b)}}},itemtaphold:function(c,b,f,a,d){},refresh:function(d,c){if(this.config.isSimple){var a=d.listItems;for(var b=0;b<a.length;b++){var e=a[b].getDisclosure();if(dic.ContainsKey(b)){e.show()}else{e.hide()}}}}}},getSimpleToolBar:function(){var a=Ext.create("Ext.TitleBar",this.config.simpleToolBar);a.addCls("deleteToolbar");return a},beginSimple:function(a,c,b){if(!this.config.isSimple){this.deselectAll();this.setMode("SIMPLE");this.addCls(this.config.editCls);this.setOnItemDisclosure(true);this.config.isSimple=true;if(a){this.config.simpleType=a}else{this.config.simpleType=this.config.defSimpleType}if(c){this.config.simpleToolBar.title=c}else{this.config.simpleToolBar.title=this.config.simpleToolBar.defTitle}this.add(this.getSimpleToolBar())}},endSimple:function(){var a=this.down("titlebar");if(a){a.hide();a.destroy();this.deselectAll();this.setMode("SINGLE");this.removeCls(this.config.editCls);this.setOnItemDisclosure(false);this.config.isSimple=false}},selectAllRows:function(){var a=this.listItems;for(var b=0,c=a.length;b<c;b++){var d=a[b].getDisclosure();d.show();dic.Add(b,b)}},unselectAllRows:function(){var a=this.listItems;for(var b=0,c=a.length;b<c;b++){var d=a[b].getDisclosure();d.hide();dic.Remove(b)}},updateOnItemDisclosure:function(d,b){if(b==null){return}var a=this.listItems;for(var c=0,e=a.length;c<e;c++){var f=a[c].getDisclosure();f.hide()}}});
;
Ext.define("ux.TabBar",{alternateClassName:"tabBar",extend:"Ext.Toolbar",xtype:"tabBar",config:{docked:"bottom",cls:"navToolbar",layout:{align:"stretch"},defaults:{flex:1,pressedCls:""},selectButton:null},initialize:function(){var a=this;a.callParent();a.on({delegate:"> button",scope:a,tap:"onButtonTap"})},updateSelectButton:function(a,b){if(b){b.removeCls("x-tabBar-pressing")}if(a){a.addCls("x-tabBar-pressing")}},onButtonTap:function(a){if(!a.getInitialConfig("noSelect")){this.setSelectButton(a)}},onItemAdd:function(b,a){if(!this.getSelectButton()&&b.getInitialConfig("selected")){this.setSelectButton(b)}this.callParent(arguments)}});
;
Ext.define("ux.TouchCalendar",{extend:"Ext.carousel.Carousel",xtype:"calendar",config:{viewMode:"month",enableSwipeNavigate:true,enableSimpleEvents:false,enableEventBars:false,viewConfig:{}},defaultViewConfig:{viewMode:"MONTH",weekStart:1,bubbleEvents:["selectionchange"]},indicator:false,initialize:function(){this.viewConfig=Ext.applyIf(this.viewConfig||{},this.defaultViewConfig);this.viewConfig.currentDate=this.viewConfig.currentDate||this.viewConfig.value||new Date();this.setViewMode(this.viewConfig.viewMode.toUpperCase());this.initViews();Ext.apply(this,{cls:"touch-calendar",activeItem:(this.getEnableSwipeNavigate()?1:0),direction:"horizontal"});this.setIndicator(false);this.setActiveItem(1);this.on("selectionchange",this.onSelectionChange);this.on("activeitemchange",this.onActiveItemChange);if(this.getEnableSwipeNavigate()){this.on(this.element,{drag:this.onDrag,dragThreshold:5,dragend:this.onDragEnd,direction:this.direction,scope:this});this.element.addCls(this.baseCls+"-"+this.direction)}},getViewConfig:function(f){var e=[];if(this.getEnableSimpleEvents()){var d=Ext.isObject(this.getEnableSimpleEvents())?this.getEnableSimpleEvents():{};e.push(Ext.create("ux.TouchCalendarSimpleEvents",d))}else{if(this.getEnableEventBars()){var d=Ext.isObject(this.getEnableEventBars())?this.getEnableEventBars():{};e.push(Ext.create("ux.TouchCalendarEvents",d))}}Ext.apply(this._viewConfig,{plugins:e,currentDate:f,viewMode:this.getViewMode(),onTableHeaderTap:Ext.bind(this.onTableHeaderTap,this),bubbleEvents:["periodchange","eventtap","selectionchange"]});return this._viewConfig},getViewDate:function(f,e){var g=(this.getViewMode()==="WEEK"?"DAY":this.getViewMode().toUpperCase()),h=(this.getViewMode()==="WEEK"?(8*e):e);return Ext.Date.add(f,Ext.Date[g],h)},initViews:function(){var l=[];var i=Ext.Date.clone(this.viewConfig.currentDate),k=(this.getEnableSwipeNavigate()?-1:0),h=(this.getEnableSwipeNavigate()?1:0),g=[];var j=this.getViewDate(i,-1);l.push(Ext.create("ux.TouchCalendarView",Ext.applyIf({currentDate:j},this.getViewConfig(j))));l.push(Ext.create("ux.TouchCalendarView",ux.TouchCalendarView(this.getViewConfig(i))));j=this.getViewDate(i,1);l.push(Ext.create("ux.TouchCalendarView",ux.TouchCalendarView(Ext.applyIf({currentDate:j},this.getViewConfig(j)))));this.setItems(l);this.view=l[(this.getEnableSwipeNavigate()?1:0)]},onTableHeaderTap:function(c,d){d=Ext.fly(d);if(d.hasCls(this.view.getPrevPeriodCls())||d.hasCls(this.view.getNextPeriodCls())){this[(d.hasCls(this.view.getPrevPeriodCls())?"previous":"next")]()}},applyViewMode:function(b){return b.toUpperCase()},updateViewMode:function(b){this.viewConfig=this.viewConfig||{};this.viewConfig.viewMode=b;if(this.view){Ext.each(this.getInnerItems(),function(a,d){a.currentDate=this.getViewDate(Ext.Date.clone(this.view.currentDate),d-1);a.setViewMode(b,true);a.refresh()},this)}},getValue:function(){var b=this.view.getSelected();return(b.length>0)?b:null},setValue:function(b){this.view.setValue(b)},onActiveItemChange:function(r,l,q){if(this.getEnableSwipeNavigate()){var o=this.getItems();var k=o.indexOf(l),n=o.indexOf(q),m=(k>n)?"forward":"backward";this.counter=(this.counter||0)+1;if(m==="forward"){this.remove(o.get(0));var p=new ux.TouchCalendarView(this.getViewConfig(this.getViewDate(l.currentDate,1)));this.add(p)}else{this.remove(o.get(o.getCount()-1));var p=new ux.TouchCalendarView(this.getViewConfig(this.getViewDate(l.currentDate,-1)));this.insert(0,p)}this.view=l;var j=this.view.getPeriodMinMaxDate();this.fireEvent("periodchange",this.view,j.min.get("date"),j.max.get("date"),m)}}});Ext.define("ux.TouchCalendarView",{extend:"Ext.Container",alias:"widget.touchcalendarview",config:{viewMode:"month",weekStart:1,todayCls:"today",selectedItemCls:"selected",unselectableCls:"unselectable",prevMonthCls:"prev-month",nextMonthCls:"next-month",weekendCls:"weekend",prevPeriodCls:"goto-prev",nextPeriodCls:"goto-next",dayTimeSlotSize:30,timeSlotDateTpls:{},hideHalfHourTimeSlotLabels:true,value:null,store:null,baseTpl:['<table class="{[this.me.getViewMode().toLowerCase()]}">',"<thead>","<tr>",'<tpl for="this.getDaysArray(values)">','<th class="{[this.getHeaderClass(xindex)]}">','<tpl if="xindex === 4">','<span>{[Ext.Date.format(this.me.currentDate, "F")]} {[Ext.Date.format(this.me.currentDate, "Y")]}</span>',"</tpl>",'{date:date("D")}',"</th>","</tpl>","</tr>","</thead>","<tbody>",'<tr class="time-block-row">','<tpl for=".">','<td class="time-block {[this.getClasses(values)]}" datetime="{[this.me.getDateAttribute(values.date)]}">',"{date:this.formatDate()}","</td>",'<tpl if="this.isEndOfRow(xindex)">',"</tr>",'<tpl if="!this.isEndOfPeriod(xindex)">',"<tr>","</tpl>","</tpl>","</tpl>","</tr>","</tbody>","</table>"],cls:"touch-calendar-view",itemSelector:"td.time-block"},timeSlotDateTplsDefaults:{day:'<span class="hour">{date:date("g")}</span><span class="am-pm">{date:date("A")}</span>',month:'{date:date("j")}',week:'{date:date("j")}'},commonTemplateFunctions:{getTimeSlotRowCls:function(d){var f=[],e=d.getMinutes()!==0;if(e){f.push("half-hour")}return f.join(" ")},isHalfHour:function(b){return b.getMinutes()!==0},formatDate:function(b){return this.getTimeSlotDateTpl().apply({date:b})},getTimeSlotDateTpl:function(){var b=this.me.getViewMode().toLowerCase();return this.me.getTimeSlotDateTpls()[b]},getClasses:function(d){var c=[];if(d.selected){c.push(this.me.getSelectedItemCls())}if(d.unselectable){c.push(this.me.getUnselectableCls())}if(d.prevMonth){c.push(this.me.getPrevMonthCls())}if(d.nextMonth){c.push(this.me.getNextMonthCls())}if(d.weekend){c.push(this.me.getWeekendCls())}if(d.today){c.push(this.me.getTodayCls())}return c.join(" ")},isEndOfRow:function(b){return(b%7)===0&&(b>0)},isStartOfRow:function(b){return((b-1)%7)===0&&(b-1>=0)},isEndOfPeriod:function(b){return b%this.me.periodRowDayCount===0},getDaysArray:function(e){var f=[],d;for(d=0;d<this.me.periodRowDayCount;d++){f.push(e[d])}return f},getHeaderClass:function(b){return b===1?this.me.getPrevPeriodCls():b===7?this.me.getNextPeriodCls():""}},constructor:function(c){this.initModel();var d=Ext.create("Ext.data.Store",{model:"TouchCalendarViewModel"});this.setStore(d);c.timeSlotDateTpls=c.timeSlotDateTpls||{};Ext.applyIf(c.timeSlotDateTpls,this.timeSlotDateTplsDefaults);Ext.apply(this,c||{});this.callParent(arguments);this.minDate=this.minDate?Ext.Date.clearTime(this.minDate,true):null;this.maxDate=this.maxDate?Ext.Date.clearTime(this.maxDate,true):null;this.refresh()},initialize:function(){this.element.on({tap:this.onTableHeaderTap,scope:this,delegate:"th"});this.element.on({tap:this.onTimeSlotTap,scope:this,delegate:this.getItemSelector()});this.on({painted:this.syncHeight,resize:this.onComponentResize,scope:this});this.callParent()},initModel:function(){if(!Ext.ModelManager.isRegistered("TouchCalendarViewModel")){Ext.define("TouchCalendarViewModel",{extend:"Ext.data.Model",config:{fields:[{name:"date",type:"date"},{name:"today",type:"boolean"},{name:"unselectable",type:"boolean"},{name:"selected",type:"boolean"},{name:"prevMonth",type:"boolean"},{name:"nextMonth",type:"boolean"},{name:"weekend",type:"boolean"},"timeSlots"]}})}},updateViewMode:function(e,f){this.refresh();var d=this.getPeriodMinMaxDate();this.fireEvent("periodchange",this,d.min.get("date"),d.max.get("date"),"none")},applyViewMode:function(c){c=c.toUpperCase();var d=ux.TouchCalendarView[c.toUpperCase()];this.getStartDate=d.getStartDate;this.getTotalDays=d.getTotalDays;this.dateAttributeFormat=d.dateAttributeFormat;this.getNextIterationDate=d.getNextIterationDate;this.getDeltaDate=d.getDeltaDate;this.periodRowDayCount=d.periodRowDayCount;Ext.apply(this.commonTemplateFunctions,{me:this});this.setTpl(new Ext.XTemplate((d.tpl||this.getBaseTpl()).join(""),this.commonTemplateFunctions));this.setScrollable({direction:c.toUpperCase()==="DAY"?"vertical":false,directionLock:true});return c},collectData:function(d){var c=[];Ext.each(d,function(b,a){c.push(b.data)},this);return c},populateStore:function(){this.currentDate=this.currentDate||this.value||new Date();var k=true,j=this.currentDate,l=this.getStartDate(j),i=this.getTotalDays(j),h;this.getStore().suspendEvents();this.getStore().data.clear();for(var g=0;g<i;g++){l=this.getNextIterationDate(l,(g===0?0:1));k=(this.minDate&&l<this.minDate)||(this.maxDate&&l>this.maxDate);h=Ext.create("TouchCalendarViewModel",{today:this.isSameDay(l,new Date()),unselectable:k,selected:this.isSameDay(l,this.value)&&!k,prevMonth:(l.getMonth()<j.getMonth()),nextMonth:(l.getMonth()>j.getMonth()),weekend:this.isWeekend(l),date:l});this.getStore().add(h)}this.getStore().resumeEvents()},refreshDelta:function(g){var e=this.currentDate||new Date();var f=this.getDeltaDate(e,g);if(this.isOutsideMinMax(f)){return}this.currentDate=f;this.refresh();var h=this.getPeriodMinMaxDate();this.fireEvent("periodchange",this,h.min.get("date"),h.max.get("date"),(g>0?"forward":"back"))},getPeriodMinMaxDate:function(){return{min:this.getStore().data.first(),max:this.getStore().data.last()}},isOutsideMinMax:function(d){var c=false;if(this.getViewMode()==="MONTH"){c=((this.minDate&&Ext.Date.getLastDateOfMonth(d)<this.minDate)||(this.maxDate&&Ext.Date.getFirstDateOfMonth(d)>this.maxDate))}else{c=((this.minDate&&this.getWeekendDate(d)<this.minDate)||(this.maxDate&&this.getStartDate(d)>this.maxDate))}return c},onTableHeaderTap:function(c,d){d=Ext.fly(d);if(d.hasCls(this.getPrevPeriodCls())||d.hasCls(this.getNextPeriodCls())){this.refreshDelta(d.hasCls(this.getPrevPeriodCls())?-1:1)}},onTimeSlotTap:function(g){if(!g.getTarget("."+this.getUnselectableCls())){var h=Ext.fly(g.getTarget());this.selectCell(h);var e=this.getCellDate(h);var f=this.getValue()||this.currentDate;if(e.getTime()!==f.getTime()){this.setValue(e);this.fireEvent("selectionchange",this,e,f)}}},onComponentResize:function(b){this.syncHeight()},refresh:function(){this.populateStore();var b=this.getStore().getRange();this.setData(this.collectData(b));this.syncHeight()},syncHeight:function(){if(this.getViewMode().toUpperCase()!=="DAY"){var b=this.element.select("table",this.element.dom).first();if(b){b.setHeight(this.element.getHeight())}}},selectCell:function(e){var d=this.getSelectedItemCls();var f=this.element.select("."+d,this.element.dom);if(f){f.removeCls(d)}e.addCls(d);e.up("tr").addCls(d)},getDateRecord:function(b){return this.getStore().findBy(function(a){var d=Ext.Date.clearTime(a.get("date"),true).getTime();return d===Ext.Date.clearTime(b,true).getTime()},this)},getDayStartDate:function(b){return b},isSameDay:function(c,d){if(!c||!d){return false}return Ext.Date.clearTime(c,true).getTime()===Ext.Date.clearTime(d,true).getTime()},isWeekend:function(b){return b.getDay()===0||b.getDay()===6},getWeekendDate:function(c){var d=c.getDay()-this.getWeekStart();d=d<0?6:d;return new Date(c.getFullYear(),c.getMonth(),c.getDate()+0+d)},getCellDate:function(c){var d=c.dom.getAttribute("datetime");return this.stringToDate(d)},getDateCell:function(b){return this.element.select('td[datetime="'+this.getDateAttribute(b)+'"]',this.element.dom).first()},getDateAttribute:function(b){return Ext.Date.format(b,this.dateAttributeFormat)},getSelected:function(){var d=this.element.select("td."+this.getSelectedItemCls(),this.element.dom),c=[];d.each(function(a){c.push(this.getCellDate(a))},this);return c},stringToDate:function(b){return Ext.Date.parseDate(b,this.dateAttributeFormat)},applyTimeSlotDateTpls:function(b){Ext.Object.each(b,function(a,d){if(Ext.isString){b[a]=Ext.create("Ext.XTemplate",d)}},this);return b},statics:{MONTH:{dateAttributeFormat:"d-m-Y",getNextIterationDate:function(c,d){return new Date(c.getFullYear(),c.getMonth(),c.getDate()+(d===0?0:1))},getTotalDays:function(d){var c=Ext.Date.getFirstDateOfMonth(d);return this.isWeekend(c)?42:35},getStartDate:function(b){return Ext.bind(ux.TouchCalendarView.WEEK.getStartDate,this)(new Date(b.getFullYear(),b.getMonth(),1))},getDeltaDate:function(e,g){var h=e.getMonth()+g,f=new Date(e.getFullYear(),h,1);f.setDate(Ext.Date.getDaysInMonth(f)<e.getDate()?Ext.Date.getDaysInMonth(f):e.getDate());return f},periodRowDayCount:7},WEEK:{dateAttributeFormat:"d-m-Y",getNextIterationDate:function(c,d){return new Date(c.getFullYear(),c.getMonth(),c.getDate()+(d===0?0:1))},getTotalDays:function(b){return 7},getStartDate:function(c){var d=c.getDay()-this.getWeekStart();d=d<0?6:d;return new Date(c.getFullYear(),c.getMonth(),c.getDate()-0-d)},getDeltaDate:function(d,c){return new Date(d.getFullYear(),d.getMonth(),d.getDate()+(c*7))},periodRowDayCount:7},DAY:{dateAttributeFormat:"d-m-Y H:i",tpl:['<table class="{[this.me.getViewMode().toLowerCase()]}">',"<thead>","<tr>",'<th class="{[this.me.getPrevPeriodCls()]} style="display: block;">',"</th>","<th>",'<span>{[Ext.Date.format(values[0].date, "D jS M Y")]}</span>',"</th>",'<th class="{[this.me.getNextPeriodCls()]} style="display: block;"">',"</th>","</tr>","</thead>","<tbody>","<tr>",'<td colspan="3">','<table class="time-slot-table">','<tpl for=".">','<tr class="{[this.getTimeSlotRowCls(values.date)]}">','<td class="label">','<tpl if="!this.me.getHideHalfHourTimeSlotLabels() || !this.isHalfHour(values.date)">',"{date:this.formatDate()}","</tpl>","</td>",'<td class="time-block" colspan="2" datetime="{[this.me.getDateAttribute(values.date)]}">',"</td>","</tr>","</tpl>","</table>","</td>","</tr>","</tbody>","</table>"],getNextIterationDate:function(d,e){var f=d.getTime()+((e===0?0:1)*(this.getDayTimeSlotSize()*60*1000));return new Date(f)},getTotalDays:function(b){return 1440/this.getDayTimeSlotSize()},getStartDate:function(b){return Ext.Date.clearTime(b,true)},getDeltaDate:function(d,c){return new Date(d.getFullYear(),d.getMonth(),d.getDate()+c)},periodRowDayCount:1}}});Ext.define("ux.TouchCalendarEventsBase",{extend:"Ext.Base",config:{calendar:null,plugin:null,eventsPerTimeSlot:{},eventSortDirection:"DESC"},constructor:function(b){this.initConfig(b);this.callParent(arguments)},generateEventBars:function(){this.eventBarStore=Ext.create("Ext.data.Store",{model:"ux.CalendarEventBarModel",data:[]});this.setEventsPerTimeSlot({});var g=this.getCalendar().getStore(),e=this.getCalendar().eventStore,f,h=0;g.each(function(c){var d=c.get("date"),b=d.getTime(),a=[];e.sort(this.getPlugin().getStartEventField(),this.getEventSortDirection());e.each(function(o){if(!this.eventFilterFn.call(this,o,o.getId(),b)){return}h=h+1;var m=this.eventBarStore.findBy(function(i,j){return i.get("EventID")===o.internalId},this);if(m>-1){f=this.eventBarStore.getAt(m);while(f.linked().getCount()>0){f=f.linked().getAt(f.linked().getCount()-1)}if(d.getDay()===this.getCalendar().getWeekStart()){a.push(f.get("BarPosition"));var p=Ext.create("ux.CalendarEventBarModel",{EventID:o.internalId,Date:d,BarLength:1,BarPosition:f.get("BarPosition"),Colour:f.get("Colour"),Record:o});f.linked().add(p)}else{a.push(f.get("BarPosition"));f.set("BarLength",f.get("BarLength")+1)}}else{var n=this.getNextFreePosition(a);a.push(n);f=Ext.create("ux.CalendarEventBarModel",{EventID:o.internalId,Date:d,BarLength:1,BarPosition:n,Colour:this.getRandomColour(),Record:o});this.eventBarStore.add(f)}},this);if(h>0){this.getEventsPerTimeSlot()[d.getTime()]=h}h=0},this)},eventBarDoesWrap:function(d){var c=Ext.Date.add(d.get("Date"),Ext.Date.DAY,(d.get("BarLength")-1));return Ext.Date.clearTime(c,true).getTime()!==Ext.Date.clearTime(d.get("Record").get(this.getPlugin().getEndEventField()),true).getTime()},eventBarHasWrapped:function(b){return Ext.Date.clearTime(b.get("Date"),true).getTime()!==Ext.Date.clearTime(b.get("Record").get(this.getPlugin().getStartEventField()),true).getTime()},getNextFreePosition:function(d){var c=0;while(d.indexOf(c)>-1){c++}return c},createEventBar:function(l,g){var h=this.eventBarDoesWrap(l),i=this.eventBarHasWrapped(l),k=[this.getPlugin().getEventBarCls(),"e-"+l.get("EventID"),(h?" wrap-end":""),(i?" wrap-start":""),g.get(this.getPlugin().getCssClassField())];var j=Ext.DomHelper.append(this.getPlugin().getEventWrapperEl(),{tag:"div",html:this.getPlugin().getEventBarTpl().apply(g.data),eventID:l.get("EventID"),cls:k.join(" ")},true);return j},getRandomColour:function(){return"#"+(Math.random()*16777215<<0).toString(16)}});Ext.define("ux.TouchCalendarDayEvents",{extend:"ux.TouchCalendarEventsBase",config:{eventSortDirection:"ASC"},eventFilterFn:function(f,h,j){var g=this.getRoundedTime(f.get(this.getPlugin().getStartEventField())).getTime(),i=this.getRoundedTime(f.get(this.getPlugin().getEndEventField())).getTime();return(g<=j)&&(i>=j)},renderEventBars:function(l){var q=this,v=l.getCount(),t=0,u;for(;t<v;t++){u=l.getAt(t);var p=u.data.Record,n=this.createEventBar(u,p),r=this.getEventBarWidth(u,50+10),s=this.getVerticalDayPosition(u),o=this.getHorizontalDayPosition(u,r),i=this.getEventBarHeight(u);n.setLeft(o);n.setTop(s-this.getCalendar().element.getY());n.setHeight(i);n.setWidth(r)}},getEventBarWidth:function(e,g){var h=this.getEventsPerTimeSlot()[e.get("Date").getTime()],f=this.getCalendar().element.getWidth();h=h||1;g=g||0;return Math.floor((f-g)/h)},getEventBarHeight:function(d){var c=this.getPlugin().getEventHeight();if(Ext.isNumeric(c)){return c}else{if(c==="duration"){return this.getEventBarHeightDuration(d)}else{return"auto"}}},getEventBarHeightDuration:function(t){var s=t.data.Record.get(this.getPlugin().getStartEventField()),q=t.data.Record.get(this.getPlugin().getEndEventField()),o=this.getRoundedTime(s),r=(q.getTime()-s.getTime())/1000/60,l=this.getCalendar().getDateCell(o),p=l.parent("tr",false),m=0;if(p){var n=l.getHeight(),k=n/30;m=r*k}return m},getVerticalDayPosition:function(v){var t=v.data.Record.get(this.getPlugin().getStartEventField()),n=this.getRoundedTime(t),l=(n.getHours()*2)+(n.getMinutes()===30?1:0),u=(t.getTime()-n.getTime())/1000/60,p=this.getCalendar().element.select("table.time-slot-table td",this.getCalendar().element.dom).first(),r=0;if(p){var s=p.getHeight(),q=p.getY(),m=s/30,o=u*m;r=q+(l*s)+o}return r},getHorizontalDayPosition:function(j,g){var i=j.get("BarPosition"),f=50,h=this.getPlugin().getEventBarSpacing();return f+(i*g)+(i*h)},getRoundedTime:function(d){d=Ext.Date.clone(d);var c=d.getMinutes();d.setMinutes(c-(c%this.getCalendar().getDayTimeSlotSize()));d.setSeconds(0);d.setMilliseconds(0);return d}});Ext.define("ux.TouchCalendarMonthEvents",{extend:"ux.TouchCalendarEventsBase",eventFilterFn:function(f,h,j){var g=Ext.Date.clearTime(f.get(this.getPlugin().getStartEventField()),true).getTime(),i=Ext.Date.clearTime(f.get(this.getPlugin().getEndEventField()),true).getTime();return(g<=j)&&(i>=j)},renderEventBars:function(d){var c=this;d.each(function(L){var F=this.getPlugin().getEventRecord(L.get("EventID")),G=this.getCalendar().getDateCell(L.get("Date")),I=this.eventBarDoesWrap(L),b=this.eventBarHasWrapped(L),K=[this.getPlugin().getEventBarCls(),"e-"+L.get("EventID"),(I?" wrap-end":""),(b?" wrap-start":""),F.get(this.getPlugin().getCssClassField())];var D=Ext.DomHelper.append(this.getPlugin().getEventWrapperEl(),{tag:"div",style:{"background-color":F.get(this.getPlugin().colourField)},html:this.getPlugin().getEventBarTpl().apply(F.data),eventID:L.get("EventID"),cls:K.join(" ")},true);if(this.allowEventDragAndDrop){new Ext.util.Draggable(D,{revert:true,onStart:function(f){var g=this,h=g.el.getAttribute("eventID"),e=c.getPlugin().getEventRecord(h),i=c.getEventBarRecord(h);g.el.setWidth(g.el.getWidth()/i.get("BarLength"));g.el.setLeft(f.startX-(g.el.getWidth()/2));c.calendar.element.select("div."+e.internalId,c.calendar.element.dom).each(function(j){if(j.dom!==g.el.dom){j.hide()}},this);Ext.util.Draggable.prototype.onStart.apply(this,arguments);c.calendar.fireEvent("eventdragstart",g,e,f);return true}})}var w=this.getCalendar().element.select("thead",this.getCalendar().element.dom).first().getHeight();var x=this.getCalendar().element.select("tbody",this.getCalendar().element.dom).first().getHeight();var B=this.getCalendar().element.select("tbody tr",this.getCalendar().element.dom).getCount();var M=x/B;var z=this.getCalendar().getStore().findBy(function(e){return e.get("date").getTime()===Ext.Date.clearTime(L.get("Date"),true).getTime()},this);var A=Math.floor(z/7)+1;var y=w+(M*A);var a=L.get("BarPosition"),E=L.get("BarLength"),N=(this.getCalendar().element.getWidth()/7)*G.dom.cellIndex,H=G.getWidth(),C=D.getHeight(),J=this.getPlugin().getEventBarSpacing();D.setLeft(N+(b?0:J));D.setTop(y-C-(a*C+(a*J)+J));D.setWidth((H*E)-(J*(I?(I&&b?0:1):2)));if(L.linked().getCount()>0){this.renderEventBars(L.linked())}},this)}});Ext.define("ux.TouchCalendarWeekEvents",{extend:"ux.TouchCalendarMonthEvents"});Ext.define("ux.TouchCalendarEvents",{extend:"Ext.mixin.Observable",config:{viewModeProcessor:null,eventBarTpl:"{title}",eventBarCls:"event-bar",colourField:"colour",cssClassField:"css",eventHeight:"duration",eventWidth:"auto",startEventField:"start",endEventField:"end",eventWrapperCls:"event-wrapper",eventBarSelectedCls:"event-bar-selected",cellHoverCls:"date-cell-hover",autoUpdateEvent:true,allowEventDragAndDrop:false,eventBarSpacing:1,eventWrapperEl:null},init:function(c){var d=this;this.calendar=c;this.calendar.eventsPlugin=this;this.calendar.refresh=Ext.Function.createSequence(this.calendar.refresh,this.refreshEvents,this);this.calendar.setViewMode=this.createPreSequence(this.calendar.setViewMode,this.onViewModeUpdate,this);this.calendar.onComponentResize=Ext.Function.createSequence(this.calendar.onComponentResize,this.onComponentResize,this);this.onViewModeUpdate(this.calendar.getViewMode())},onComponentResize:function(){var b=this;setTimeout(function(){b.refreshEvents()},200)},createPreSequence:function(d,f,e){if(!f){return d}else{return function(){f.apply(e||this,arguments);var a=d.apply(this,arguments);return a}}},onViewModeUpdate:function(b){this.setViewModeProcessor(Ext.create(this.getViewModeProcessorClass(b),{calendar:this.calendar,plugin:this}))},getViewModeProcessorClass:function(d){var c="";switch(d.toLowerCase()){case"month":c="ux.TouchCalendarMonthEvents";break;case"week":c="ux.TouchCalendarWeekEvents";break;case"day":c="ux.TouchCalendarDayEvents";break}return c},refreshEvents:function(){if(this.calendar.getScrollable()){this.calendar.getScrollable().getScroller().scrollTo(0,0)}this.removeEvents();this.getViewModeProcessor().generateEventBars();this.createEventWrapper();if(this.getAllowEventDragAndDrop()){this.createDroppableRegion()}},createDroppableRegion:function(){var c=this;var d=0},onEventDropDeactivate:function(h,g,i,j){if(g.el.hasCls(this.eventBarCls)){var e=this.getEventRecord(g.el.getAttribute("eventID"));this.calendar.element.select("div."+e.internalId,this.calendar.element.dom).each(function(a){a.show()},this)}},onEventDrop:function(h,g,i,j){var e=false;if(g.el.hasCls(this.eventBarCls)){this.calendar.all.each(function(l){var b=l.getPageBox(true);var a=g.el.getPageBox(true);if(b.partial(a)&&this.calendar.fireEvent("beforeeventdrop",g,h,f,i)){e=true;var f=this.getEventRecord(g.el.getAttribute("eventID")),d=this.calendar.getCellDate(l),c=this.getDaysDifference(f.get(this.getStartEventField()),d);if(this.getAutoUpdateEvent()){f.set(this.getStartEventField(),d);f.set(this.getEndEventField(),f.get(this.getEndEventField()).add(Date.DAY,c))}this.refreshEvents();this.calendar.fireEvent("eventdrop",g,h,f,i);return}},this);this.calendar.all.removeCls(this.getCellHoverCls());if(!e){g.setOffset(g.startOffset,true)}}},onEventDragStart:function(g,h){var i=g.el.getAttribute("eventID"),e=this.getEventRecord(i),j=this.getEventBarRecord(i);g.el.setWidth(g.el.getWidth()/j.get("BarLength"));g.updateBoundary(true);this.calendar.element.select("div."+e.internalId,this.calendar.element.dom).each(function(a){if(a.dom!==g.el.dom){a.hide()}},this);this.calendar.fireEvent("eventdragstart",g,e,h)},createEventWrapper:function(){if(this.calendar.rendered&&!this.getEventWrapperEl()){this.setEventWrapperEl(Ext.DomHelper.append(this.getEventsWrapperContainer(),{tag:"div",cls:this.getEventWrapperCls()},true));this.getEventWrapperEl().on("tap",this.onEventWrapperTap,this,{delegate:"div."+this.getEventBarCls()});if(this.getViewModeProcessor().eventBarStore){this.getViewModeProcessor().renderEventBars(this.getViewModeProcessor().eventBarStore)}}else{this.calendar.on("painted",this.createEventWrapper,this)}},onEventWrapperTap:function(i,j){i.stopPropagation();var k=i.getTarget("div."+this.getEventBarCls());if(k){var l=k.getAttribute("eventID"),e=Ext.fly(k);if(l){var h=this.getEventRecord(l);this.deselectEvents();e.addCls(this.getEventBarSelectedCls());this.calendar.fireEvent("eventtap",h,i)}}},getEventsWrapperContainer:function(){return this.calendar.element.select("thead th",this.calendar.element.dom).first()||this.calendar.element.select("tr td",this.calendar.element.dom).first()},getEventRecord:function(d){var c=this.calendar.eventStore.findBy(function(a){return a.internalId===d},this);return this.calendar.eventStore.getAt(c)},getEventBarRecord:function(d){var c=this.eventBarStore.findBy(function(a){return a.get("EventID")===d},this);return this.eventBarStore.getAt(c)},deselectEvents:function(){this.calendar.element.select("."+this.getEventBarSelectedCls(),this.calendar.element.dom).removeCls(this.getEventBarSelectedCls())},getDaysDifference:function(c,d){c=c.clearTime(true).getTime();d=d.clearTime(true).getTime();return(d-c)/1000/60/60/24},removeEvents:function(){if(this.getEventWrapperEl()){this.getEventWrapperEl().dom.innerHTML="";this.getEventWrapperEl().destroy();this.setEventWrapperEl(null)}if(this.eventBarStore){this.eventBarStore.remove(this.eventBarStore.getRange());this.eventBarStore=null}if(this.droppable){this.droppable=null}},applyEventBarTpl:function(b){if(Ext.isString(b)||Ext.isArray(b)){b=Ext.create("Ext.XTemplate",b)}return b}});Ext.define("ux.CalendarEventBarModel",{extend:"Ext.data.Model",config:{fields:[{name:"EventID",type:"string"},{name:"Date",type:"date"},{name:"BarLength",type:"int"},{name:"BarPosition",type:"int"},{name:"Colour",type:"string"},"Record"],hasMany:[{model:"ux.CalendarEventBarModel",name:"linked"}]}});Ext.define("Ext.util.Region.partial",{extend:"Ext.util.Region",partial:function(j){var k=this,l=j.right-j.left,n=j.bottom-j.top,h=k.right-k.left,i=k.bottom-k.top,m=j.top>k.top&&j.top<k.bottom;horizontalValid=j.left>k.left&&j.left<k.right;return horizontalValid&&m}});Ext.define("ux.TouchCalendarSimpleEvents",{extend:"Ext.mixin.Observable",startEventField:"start",endEventField:"end",multiEventDots:true,wrapperCls:"simple-event-wrapper",eventDotCls:"simple-event",dotWidth:6,eventTpl:['<span class="{wrapperCls}">','<tpl for="events">','<span class="{[parent.eventDotCls]}"></span>',"</tpl>","</span>"].join(""),filterFn:function(j,h,f){if(arguments.length===2){f=h}var g=Ext.Date.clearTime(j.get(this.startEventField),true).getTime(),i=Ext.Date.clearTime(j.get(this.endEventField),true).getTime(),f=Ext.Date.clearTime(f,true).getTime();return(g<=f)&&(i>=f)},init:function(b){this.calendar=b;this.calendar.simpleEventsPlugin=this;this.wrapperCls=this.wrapperCls+(this.multiEventDots?"-multi":"");this.eventDotCls=this.eventDotCls+(this.multiEventDots?"-multi":"");this.calendar.showEvents=this.showEvents;this.calendar.hideEvents=this.hideEvents;this.calendar.removeEvents=this.removeEvents;this.calendar.refresh=Ext.Function.createSequence(this.calendar.refresh,this.refreshEvents,this);this.calendar.syncHeight=Ext.Function.createSequence(this.calendar.syncHeight,this.refreshEvents,this)},refreshEvents:function(){if(!this.disabled&&this.calendar.getViewMode()!=="DAY"){var b=this.calendar.getStore();if(b){this.removeEvents();b.each(function(o){var m=o.get("date");var p=this.calendar.getDateCell(m);var n=this.calendar.eventStore;if(p){n.clearFilter();var a=n[this.multiEventDots?"filterBy":"findBy"](Ext.bind(this.filterFn,this,[m],true));var j=n.getRange().length;if((!this.multiEventDots&&a>-1)||(this.multiEventDots&&j>0)){var k=Math.min((p.getWidth()/this.dotWidth),j);var l=new Ext.XTemplate(this.eventTpl).append(p,{events:(this.multiEventDots?n.getRange().slice(0,k):["event"]),wrapperCls:this.wrapperCls,eventDotCls:this.eventDotCls},true);l.setWidth(Math.min((this.multiEventDots?n.getRange().length:1)*this.dotWidth,p.getWidth()));l.setY((p.getY()+p.getHeight())-(l.getHeight()+(p.getHeight()*0.1)));l.setX((p.getX()+(p.getWidth()/2))-(l.getWidth()/2)+2)}}},this)}}},hideEvents:function(){this.simpleEventsPlugin.disabled=true;this.calendar.element.select("span."+this.wrapperCls,this.calendar.element.dom).hide()},showEvents:function(){this.simpleEventsPlugin.disabled=false;this.calendar.element.select("span."+this.wrapperCls,this.calendar.element.dom).show()},removeEvents:function(){if(this.calendar.element){this.calendar.element.select("span."+this.wrapperCls,this.calendar.element.dom).each(function(b){Ext.destroy(b)})}}});
;
/*!
 * ux.TouchCalendarEvents
 */
Ext.define("ux.TouchCalendar",{extend:"Ext.carousel.Carousel",xtype:"calendar",config:{viewMode:"month",enableSwipeNavigate:true,enableSimpleEvents:false,enableEventBars:false,viewConfig:{}},defaultViewConfig:{viewMode:"MONTH",weekStart:1,bubbleEvents:["selectionchange"]},indicator:false,initialize:function(){this.viewConfig=Ext.applyIf(this.viewConfig||{},this.defaultViewConfig);this.viewConfig.currentDate=this.viewConfig.currentDate||this.viewConfig.value||new Date();this.setViewMode(this.viewConfig.viewMode.toUpperCase());this.initViews();Ext.apply(this,{cls:"touch-calendar",activeItem:(this.getEnableSwipeNavigate()?1:0),direction:"horizontal"});this.setIndicator(false);this.setActiveItem(1);this.on("selectionchange",this.onSelectionChange);this.on("activeitemchange",this.onActiveItemChange);if(this.getEnableSwipeNavigate()){this.on(this.element,{drag:this.onDrag,dragThreshold:5,dragend:this.onDragEnd,direction:this.direction,scope:this});this.element.addCls(this.baseCls+"-"+this.direction)}},getViewConfig:function(c){var a=[];if(this.getEnableSimpleEvents()){var b=Ext.isObject(this.getEnableSimpleEvents())?this.getEnableSimpleEvents():{};a.push(Ext.create("ux.TouchCalendarSimpleEvents",b))}else{if(this.getEnableEventBars()){var b=Ext.isObject(this.getEnableEventBars())?this.getEnableEventBars():{};a.push(Ext.create("ux.TouchCalendarEvents",b))}}Ext.apply(this._viewConfig,{plugins:a,currentDate:c,viewMode:this.getViewMode(),onTableHeaderTap:Ext.bind(this.onTableHeaderTap,this),bubbleEvents:["periodchange","eventtap","selectionchange"]});return this._viewConfig},getViewDate:function(a,b){var d=(this.getViewMode()==="WEEK"?"DAY":this.getViewMode().toUpperCase()),c=(this.getViewMode()==="WEEK"?(8*b):b);return Ext.Date.add(a,Ext.Date[d],c)},initViews:function(){var c=[];var f=Ext.Date.clone(this.viewConfig.currentDate),d=(this.getEnableSwipeNavigate()?-1:0),a=(this.getEnableSwipeNavigate()?1:0),b=[];var e=this.getViewDate(f,-1);c.push(Ext.create("ux.TouchCalendarView",Ext.applyIf({currentDate:e},this.getViewConfig(e))));c.push(Ext.create("ux.TouchCalendarView",ux.TouchCalendarView(this.getViewConfig(f))));e=this.getViewDate(f,1);c.push(Ext.create("ux.TouchCalendarView",ux.TouchCalendarView(Ext.applyIf({currentDate:e},this.getViewConfig(e)))));this.setItems(c);this.view=c[(this.getEnableSwipeNavigate()?1:0)]},onTableHeaderTap:function(b,a){a=Ext.fly(a);if(a.hasCls(this.view.getPrevPeriodCls())||a.hasCls(this.view.getNextPeriodCls())){this[(a.hasCls(this.view.getPrevPeriodCls())?"previous":"next")]()}},applyViewMode:function(a){return a.toUpperCase()},updateViewMode:function(a){this.viewConfig=this.viewConfig||{};this.viewConfig.viewMode=a;if(this.view){Ext.each(this.getInnerItems(),function(b,c){b.currentDate=this.getViewDate(Ext.Date.clone(this.view.currentDate),c-1);b.setViewMode(a,true);b.refresh()},this)}},getValue:function(){var a=this.view.getSelected();return(a.length>0)?a:null},setValue:function(a){this.view.setValue(a)},onActiveItemChange:function(a,g,b){if(this.getEnableSwipeNavigate()){var d=this.getItems();var h=d.indexOf(g),e=d.indexOf(b),f=(h>e)?"forward":"backward";this.counter=(this.counter||0)+1;if(f==="forward"){this.remove(d.get(0));var c=new ux.TouchCalendarView(this.getViewConfig(this.getViewDate(g.currentDate,1)));this.add(c)}else{this.remove(d.get(d.getCount()-1));var c=new ux.TouchCalendarView(this.getViewConfig(this.getViewDate(g.currentDate,-1)));this.insert(0,c)}this.view=g;var i=this.view.getPeriodMinMaxDate();this.fireEvent("periodchange",this.view,i.min.get("date"),i.max.get("date"),f)}}});Ext.define("ux.TouchCalendarEventsBase",{extend:"Ext.Base",config:{calendar:null,plugin:null,eventsPerTimeSlot:{},eventSortDirection:"DESC"},constructor:function(a){this.initConfig(a);this.callParent(arguments)},generateEventBars:function(){this.eventBarStore=Ext.create("Ext.data.Store",{model:"ux.CalendarEventBarModel",data:[]});this.setEventsPerTimeSlot({});var d=this.getCalendar().getStore(),b=this.getCalendar().eventStore,a,c=0;d.each(function(f){var e=f.get("date"),g=e.getTime(),h=[];b.sort(this.getPlugin().getStartEventField(),this.getEventSortDirection());b.each(function(j){if(!this.eventFilterFn.call(this,j,j.getId(),g)){return}c=c+1;var l=this.eventBarStore.findBy(function(m,n){return m.get("EventID")===j.internalId},this);if(l>-1){a=this.eventBarStore.getAt(l);while(a.linked().getCount()>0){a=a.linked().getAt(a.linked().getCount()-1)}if(e.getDay()===this.getCalendar().getWeekStart()){h.push(a.get("BarPosition"));var i=Ext.create("ux.CalendarEventBarModel",{EventID:j.internalId,Date:e,BarLength:1,BarPosition:a.get("BarPosition"),Colour:a.get("Colour"),Record:j});a.linked().add(i)}else{h.push(a.get("BarPosition"));a.set("BarLength",a.get("BarLength")+1)}}else{var k=this.getNextFreePosition(h);h.push(k);a=Ext.create("ux.CalendarEventBarModel",{EventID:j.internalId,Date:e,BarLength:1,BarPosition:k,Colour:this.getRandomColour(),Record:j});this.eventBarStore.add(a)}},this);if(c>0){this.getEventsPerTimeSlot()[e.getTime()]=c}c=0},this)},eventBarDoesWrap:function(a){var b=Ext.Date.add(a.get("Date"),Ext.Date.DAY,(a.get("BarLength")-1));return Ext.Date.clearTime(b,true).getTime()!==Ext.Date.clearTime(new Date(a.get("Record").get(this.getPlugin().getEndEventField())),true).getTime()},eventBarHasWrapped:function(a){return Ext.Date.clearTime(a.get("Date"),true).getTime()!==Ext.Date.clearTime(new Date(a.get("Record").get(this.getPlugin().getStartEventField())),true).getTime()},getNextFreePosition:function(a){var b=0;while(a.indexOf(b)>-1){b++}return b},createEventBar:function(c,b){var a=this.eventBarDoesWrap(c),f=this.eventBarHasWrapped(c),d=[this.getPlugin().getEventBarCls(),"e-"+c.get("EventID"),(a?" wrap-end":""),(f?" wrap-start":""),b.get(this.getPlugin().getCssClassField())];var e=Ext.DomHelper.append(this.getPlugin().getEventWrapperEl(),{tag:"div",html:this.getPlugin().getEventBarTpl().apply(b.data),eventID:c.get("EventID"),cls:d.join(" ")},true);return e},getRandomColour:function(){return"#"+(Math.random()*16777215<<0).toString(16)}});Ext.define("ux.TouchCalendarDayEvents",{extend:"ux.TouchCalendarEventsBase",config:{eventSortDirection:"ASC"},eventFilterFn:function(b,e,c){var a=this.getRoundedTime(new Date(b.get(this.getPlugin().getStartEventField()))).getTime(),d=this.getRoundedTime(new Date(b.get(this.getPlugin().getEndEventField()))).getTime();return(a<=c)&&(d>=c)},renderEventBars:function(k){var f=this,a=k.getCount(),c=0,b;for(;c<a;c++){b=k.getAt(c);var g=b.data.Record,j=this.createEventBar(b,g),e=this.getEventBarWidth(b,50+10),d=this.getVerticalDayPosition(b),h=this.getHorizontalDayPosition(b,e),m=this.getEventBarHeight(b);j.setLeft(h);j.setTop(d-this.getCalendar().element.getY());j.setHeight(m);j.setWidth(e)}},getEventBarWidth:function(b,d){var c=this.getEventsPerTimeSlot()[b.get("Date").getTime()],a=this.getCalendar().element.getWidth();c=c||1;d=d||0;return Math.floor((a-d)/c)},getEventBarHeight:function(a){var b=this.getPlugin().getEventHeight();if(Ext.isNumeric(b)){return b}else{if(b==="duration"){return this.getEventBarHeightDuration(a)}else{return"auto"}}},getEventBarHeightDuration:function(a){var b=a.data.Record.get(this.getPlugin().getStartEventField()),d=a.data.Record.get(this.getPlugin().getEndEventField()),f=this.getRoundedTime(b),c=(d.getTime()-b.getTime())/1000/60,i=this.getCalendar().getDateCell(f),e=i.parent("tr",false),h=0;if(e){var g=i.getHeight(),j=g/30;h=c*j}return h},getVerticalDayPosition:function(a){var c=a.data.Record.get(this.getPlugin().getStartEventField()),i=this.getRoundedTime(c),k=(i.getHours()*2)+(i.getMinutes()===30?1:0),b=(c.getTime()-i.getTime())/1000/60,g=this.getCalendar().element.select("table.time-slot-table td",this.getCalendar().element.dom).first(),e=0;if(g){var d=g.getHeight(),f=g.getY(),j=d/30,h=b*j;e=f+(k*d)+h}return e},getHorizontalDayPosition:function(c,a){var d=c.get("BarPosition"),b=50,e=this.getPlugin().getEventBarSpacing();return b+(d*a)+(d*e)},getRoundedTime:function(a){a=Ext.Date.clone(a);var b=a.getMinutes();a.setMinutes(b-(b%this.getCalendar().getDayTimeSlotSize()));a.setSeconds(0);a.setMilliseconds(0);return a}});Ext.define("ux.TouchCalendarMonthEvents",{extend:"ux.TouchCalendarEventsBase",eventFilterFn:function(b,e,c){var a=Ext.Date.clearTime(new Date(b.get(this.getPlugin().getStartEventField())),true).getTime(),d=Ext.Date.clearTime(new Date(b.get(this.getPlugin().getEndEventField())),true).getTime();return(a<=c)&&(d>=c)},renderEventBars:function(a){var b=this;a.each(function(e){var k=this.getPlugin().getEventRecord(e.get("EventID")),j=this.getCalendar().getDateCell(e.get("Date")),h=this.eventBarDoesWrap(e),u=this.eventBarHasWrapped(e),f=[this.getPlugin().getEventBarCls(),"e-"+e.get("EventID"),(h?" wrap-end":""),(u?" wrap-start":""),k.get(this.getPlugin().getCssClassField())];var m=Ext.DomHelper.append(this.getPlugin().getEventWrapperEl(),{tag:"div",style:{"background-color":k.get(this.getPlugin().colourField)},html:this.getPlugin().getEventBarTpl().apply(k.data),eventID:e.get("EventID"),cls:f.join(" ")},true);if(this.allowEventDragAndDrop){new Ext.util.Draggable(m,{revert:true,onStart:function(A){var w=this,z=w.el.getAttribute("eventID"),x=b.getPlugin().getEventRecord(z),y=b.getEventBarRecord(z);w.el.setWidth(w.el.getWidth()/y.get("BarLength"));w.el.setLeft(A.startX-(w.el.getWidth()/2));b.calendar.element.select("div."+x.internalId,b.calendar.element.dom).each(function(B){if(B.dom!==w.el.dom){B.hide()}},this);Ext.util.Draggable.prototype.onStart.apply(this,arguments);b.calendar.fireEvent("eventdragstart",w,x,A);return true}})}var t=this.getCalendar().element.select("thead",this.getCalendar().element.dom).first().getHeight();var s=this.getCalendar().element.select("tbody",this.getCalendar().element.dom).first().getHeight();var o=this.getCalendar().element.select("tbody tr",this.getCalendar().element.dom).getCount();var d=s/o;var q=this.getCalendar().getStore().findBy(function(w){return w.get("date").getTime()===Ext.Date.clearTime(e.get("Date"),true).getTime()},this);var p=Math.floor(q/7)+1;var r=t+(d*p);var v=e.get("BarPosition"),l=e.get("BarLength"),c=(this.getCalendar().element.getWidth()/7)*j.dom.cellIndex,i=j.getWidth(),n=m.getHeight(),g=this.getPlugin().getEventBarSpacing();m.setLeft(c+(u?0:g));m.setTop(r-n-(v*n+(v*g)+g));m.setWidth((i*l)-(g*(h?(h&&u?0:1):2)));if(e.linked().getCount()>0){this.renderEventBars(e.linked())}},this)}});Ext.define("ux.TouchCalendarWeekEvents",{extend:"ux.TouchCalendarMonthEvents"});Ext.define("ux.TouchCalendarEvents",{extend:"Ext.mixin.Observable",config:{viewModeProcessor:null,eventBarTpl:"{title}",eventBarCls:"event-bar",colourField:"colour",cssClassField:"css",eventHeight:"duration",eventWidth:"auto",startEventField:"start",endEventField:"end",eventWrapperCls:"event-wrapper",eventBarSelectedCls:"event-bar-selected",cellHoverCls:"date-cell-hover",autoUpdateEvent:true,allowEventDragAndDrop:false,eventBarSpacing:1,eventWrapperEl:null},init:function(b){var a=this;this.calendar=b;this.calendar.eventsPlugin=this;this.calendar.refresh=Ext.Function.createSequence(this.calendar.refresh,this.refreshEvents,this);this.calendar.setViewMode=this.createPreSequence(this.calendar.setViewMode,this.onViewModeUpdate,this);this.calendar.onComponentResize=Ext.Function.createSequence(this.calendar.onComponentResize,this.onComponentResize,this);this.onViewModeUpdate(this.calendar.getViewMode())},onComponentResize:function(){var a=this;setTimeout(function(){a.refreshEvents()},200)},createPreSequence:function(b,c,a){if(!c){return b}else{return function(){c.apply(a||this,arguments);var d=b.apply(this,arguments);return d}}},onViewModeUpdate:function(a){this.setViewModeProcessor(Ext.create(this.getViewModeProcessorClass(a),{calendar:this.calendar,plugin:this}))},getViewModeProcessorClass:function(a){var b="";switch(a.toLowerCase()){case"month":b="ux.TouchCalendarMonthEvents";break;case"week":b="ux.TouchCalendarWeekEvents";break;case"day":b="ux.TouchCalendarDayEvents";break}return b},refreshEvents:function(){if(this.calendar.getScrollable()){this.calendar.getScrollable().getScroller().scrollTo(0,0)}this.removeEvents();this.getViewModeProcessor().generateEventBars();this.createEventWrapper();if(this.getAllowEventDragAndDrop()){this.createDroppableRegion()}},createDroppableRegion:function(){var b=this;var a=0},onEventDropDeactivate:function(f,a,d,c){if(a.el.hasCls(this.eventBarCls)){var b=this.getEventRecord(a.el.getAttribute("eventID"));this.calendar.element.select("div."+b.internalId,this.calendar.element.dom).each(function(e){e.show()},this)}},onEventDrop:function(f,a,d,c){var b=false;if(a.el.hasCls(this.eventBarCls)){this.calendar.all.each(function(e){var j=e.getPageBox(true);var k=a.el.getPageBox(true);if(j.partial(k)&&this.calendar.fireEvent("beforeeventdrop",a,f,g,d)){b=true;var g=this.getEventRecord(a.el.getAttribute("eventID")),h=this.calendar.getCellDate(e),i=this.getDaysDifference(g.get(this.getStartEventField()),h);if(this.getAutoUpdateEvent()){g.set(this.getStartEventField(),h);g.set(this.getEndEventField(),g.get(this.getEndEventField()).add(Date.DAY,i))}this.refreshEvents();this.calendar.fireEvent("eventdrop",a,f,g,d);return}},this);this.calendar.all.removeCls(this.getCellHoverCls());if(!b){a.setOffset(a.startOffset,true)}}},onEventDragStart:function(a,f){var d=a.el.getAttribute("eventID"),b=this.getEventRecord(d),c=this.getEventBarRecord(d);a.el.setWidth(a.el.getWidth()/c.get("BarLength"));a.updateBoundary(true);this.calendar.element.select("div."+b.internalId,this.calendar.element.dom).each(function(e){if(e.dom!==a.el.dom){e.hide()}},this);this.calendar.fireEvent("eventdragstart",a,b,f)},createEventWrapper:function(){if(this.calendar.rendered&&!this.getEventWrapperEl()){this.setEventWrapperEl(Ext.DomHelper.append(this.getEventsWrapperContainer(),{tag:"div",cls:this.getEventWrapperCls()},true));this.getEventWrapperEl().on("tap",this.onEventWrapperTap,this,{delegate:"div."+this.getEventBarCls()});if(this.getViewModeProcessor().eventBarStore){this.getViewModeProcessor().renderEventBars(this.getViewModeProcessor().eventBarStore)}}else{this.calendar.on("painted",this.createEventWrapper,this)}},onEventWrapperTap:function(g,f){g.stopPropagation();var d=g.getTarget("div."+this.getEventBarCls());if(d){var c=d.getAttribute("eventID"),b=Ext.fly(d);if(c){var a=this.getEventRecord(c);this.deselectEvents();b.addCls(this.getEventBarSelectedCls());this.calendar.fireEvent("eventtap",a,g)}}},getEventsWrapperContainer:function(){return this.calendar.element.select("thead th",this.calendar.element.dom).first()||this.calendar.element.select("tr td",this.calendar.element.dom).first()},getEventRecord:function(a){var b=this.calendar.eventStore.findBy(function(c){return c.internalId===a},this);return this.calendar.eventStore.getAt(b)},getEventBarRecord:function(a){var b=this.eventBarStore.findBy(function(c){return c.get("EventID")===a},this);return this.eventBarStore.getAt(b)},deselectEvents:function(){this.calendar.element.select("."+this.getEventBarSelectedCls(),this.calendar.element.dom).removeCls(this.getEventBarSelectedCls())},getDaysDifference:function(b,a){b=b.clearTime(true).getTime();a=a.clearTime(true).getTime();return(a-b)/1000/60/60/24},removeEvents:function(){if(this.getEventWrapperEl()){this.getEventWrapperEl().dom.innerHTML="";this.getEventWrapperEl().destroy();this.setEventWrapperEl(null)}if(this.eventBarStore){this.eventBarStore.remove(this.eventBarStore.getRange());this.eventBarStore=null}if(this.droppable){this.droppable=null}},applyEventBarTpl:function(a){if(Ext.isString(a)||Ext.isArray(a)){a=Ext.create("Ext.XTemplate",a)}return a}});Ext.define("ux.CalendarEventBarModel",{extend:"Ext.data.Model",config:{fields:[{name:"EventID",type:"string"},{name:"Date",type:"date"},{name:"BarLength",type:"int"},{name:"BarPosition",type:"int"},{name:"Colour",type:"string"},"Record"],hasMany:[{model:"ux.CalendarEventBarModel",name:"linked"}]}});Ext.define("Ext.util.Region.partial",{extend:"Ext.util.Region",partial:function(g){var f=this,e=g.right-g.left,c=g.bottom-g.top,b=f.right-f.left,a=f.bottom-f.top,d=g.top>f.top&&g.top<f.bottom;horizontalValid=g.left>f.left&&g.left<f.right;return horizontalValid&&d}});
;
Ext.define("ux.TouchCalendarSimpleEvents",{extend:"Ext.mixin.Observable",startEventField:"start",endEventField:"end",multiEventDots:true,wrapperCls:"simple-event-wrapper",eventDotCls:"simple-event",dotWidth:6,eventTpl:['<span class="{wrapperCls}">','<tpl for="events">','<span class="{[parent.eventDotCls]}"></span>',"</tpl>","</span>"].join(""),filterFn:function(c,e,b){if(arguments.length===2){b=e}var a=Ext.Date.clearTime(c.get(this.startEventField),true).getTime(),d=Ext.Date.clearTime(c.get(this.endEventField),true).getTime(),b=Ext.Date.clearTime(b,true).getTime();return(a<=b)&&(d>=b)},init:function(a){this.calendar=a;this.calendar.simpleEventsPlugin=this;this.wrapperCls=this.wrapperCls+(this.multiEventDots?"-multi":"");this.eventDotCls=this.eventDotCls+(this.multiEventDots?"-multi":"");this.calendar.showEvents=this.showEvents;this.calendar.hideEvents=this.hideEvents;this.calendar.removeEvents=this.removeEvents;this.calendar.refresh=Ext.Function.createSequence(this.calendar.refresh,this.refreshEvents,this);this.calendar.syncHeight=Ext.Function.createSequence(this.calendar.syncHeight,this.refreshEvents,this)},refreshEvents:function(){if(!this.disabled){var a=this.calendar.getStore();if(a){this.removeEvents();a.each(function(d){var f=d.get("date");var c=this.calendar.getDateCell(f);var e=this.calendar.eventStore;if(c){e.clearFilter();var b=e[this.multiEventDots?"filterBy":"findBy"](Ext.bind(this.filterFn,this,[f],true));var i=e.getRange().length;if((!this.multiEventDots&&b>-1)||(this.multiEventDots&&i>0)){var h=Math.min((c.getWidth()/this.dotWidth),i);var g=new Ext.XTemplate(this.eventTpl).append(c,{events:(this.multiEventDots?e.getRange().slice(0,h):["event"]),wrapperCls:this.wrapperCls,eventDotCls:this.eventDotCls},true);g.setWidth(Math.min((this.multiEventDots?e.getRange().length:1)*this.dotWidth,c.getWidth()));g.setY((c.getY()+c.getHeight())-(g.getHeight()+(c.getHeight()*0.1)));g.setX((c.getX()+(c.getWidth()/2))-(g.getWidth()/2)+2)}}},this)}}},hideEvents:function(){this.simpleEventsPlugin.disabled=true;this.calendar.element.select("span."+this.wrapperCls).hide()},showEvents:function(){this.simpleEventsPlugin.disabled=false;this.calendar.element.select("span."+this.wrapperCls).show()},removeEvents:function(){if(this.calendar.element){this.calendar.element.select("span."+this.wrapperCls).remove()}}});
;
Ext.define("ux.TouchCalendarView",{extend:"Ext.Container",alias:"widget.touchcalendarview",config:{viewMode:"month",weekStart:1,todayCls:"today",selectedItemCls:"selected",unselectableCls:"unselectable",prevMonthCls:"prev-month",nextMonthCls:"next-month",weekendCls:"weekend",prevPeriodCls:"goto-prev",nextPeriodCls:"goto-next",dayTimeSlotSize:30,timeSlotDateTpls:{},hideHalfHourTimeSlotLabels:true,value:null,store:null,baseTpl:['<table class="{[this.me.getViewMode().toLowerCase()]}">',"<thead>","<tr>",'<tpl for="this.getDaysArray(values)">','<th class="{[this.getHeaderClass(xindex)]}">','<tpl if="xindex === 4">','<span>{[Ext.Date.format(this.me.currentDate, "F")]} {[Ext.Date.format(this.me.currentDate, "Y")]}</span>',"</tpl>",'{date:date("D")}',"</th>","</tpl>","</tr>","</thead>","<tbody>",'<tr class="time-block-row">','<tpl for=".">','<td class="time-block {[this.getClasses(values)]}" datetime="{[this.me.getDateAttribute(values.date)]}">',"{date:this.formatDate()}","</td>",'<tpl if="this.isEndOfRow(xindex)">',"</tr>",'<tpl if="!this.isEndOfPeriod(xindex)">',"<tr>","</tpl>","</tpl>","</tpl>","</tr>","</tbody>","</table>"],cls:"touch-calendar-view",itemSelector:"td.time-block"},timeSlotDateTplsDefaults:{day:'<span class="hour">{date:date("g")}</span><span class="am-pm">{date:date("A")}</span>',month:'{date:date("j")}',week:'{date:date("j")}'},commonTemplateFunctions:{getTimeSlotRowCls:function(d){var f=[],e=d.getMinutes()!==0;if(e){f.push("half-hour")}return f.join(" ")},isHalfHour:function(b){return b.getMinutes()!==0},formatDate:function(b){return this.getTimeSlotDateTpl().apply({date:b})},getTimeSlotDateTpl:function(){var b=this.me.getViewMode().toLowerCase();return this.me.getTimeSlotDateTpls()[b]},getClasses:function(d){var c=[];if(d.selected){c.push(this.me.getSelectedItemCls())}if(d.unselectable){c.push(this.me.getUnselectableCls())}if(d.prevMonth){c.push(this.me.getPrevMonthCls())}if(d.nextMonth){c.push(this.me.getNextMonthCls())}if(d.weekend){c.push(this.me.getWeekendCls())}if(d.today){c.push(this.me.getTodayCls())}return c.join(" ")},isEndOfRow:function(b){return(b%7)===0&&(b>0)},isStartOfRow:function(b){return((b-1)%7)===0&&(b-1>=0)},isEndOfPeriod:function(b){return b%this.me.periodRowDayCount===0},getDaysArray:function(e){var f=[],d;for(d=0;d<this.me.periodRowDayCount;d++){f.push(e[d])}return f},getHeaderClass:function(b){return b===1?this.me.getPrevPeriodCls():b===7?this.me.getNextPeriodCls():""}},constructor:function(c){this.initModel();var d=Ext.create("Ext.data.Store",{model:"TouchCalendarViewModel"});this.setStore(d);c.timeSlotDateTpls=c.timeSlotDateTpls||{};Ext.applyIf(c.timeSlotDateTpls,this.timeSlotDateTplsDefaults);Ext.apply(this,c||{});this.callParent(arguments);this.minDate=this.minDate?Ext.Date.clearTime(this.minDate,true):null;this.maxDate=this.maxDate?Ext.Date.clearTime(this.maxDate,true):null;this.refresh()},initialize:function(){this.element.on({tap:this.onTableHeaderTap,scope:this,delegate:"th"});this.element.on({tap:this.onTimeSlotTap,scope:this,delegate:this.getItemSelector()});this.on({painted:this.syncHeight,resize:this.onComponentResize,scope:this});this.callParent()},initModel:function(){if(!Ext.ModelManager.isRegistered("TouchCalendarViewModel")){Ext.define("TouchCalendarViewModel",{extend:"Ext.data.Model",config:{fields:[{name:"date",type:"date"},{name:"today",type:"boolean"},{name:"unselectable",type:"boolean"},{name:"selected",type:"boolean"},{name:"prevMonth",type:"boolean"},{name:"nextMonth",type:"boolean"},{name:"weekend",type:"boolean"},"timeSlots"]}})}},updateViewMode:function(e,f){this.refresh();var d=this.getPeriodMinMaxDate();this.fireEvent("periodchange",this,d.min.get("date"),d.max.get("date"),"none")},applyViewMode:function(c){c=c.toUpperCase();var d=ux.TouchCalendarView[c.toUpperCase()];this.getStartDate=d.getStartDate;this.getTotalDays=d.getTotalDays;this.dateAttributeFormat=d.dateAttributeFormat;this.getNextIterationDate=d.getNextIterationDate;this.getDeltaDate=d.getDeltaDate;this.periodRowDayCount=d.periodRowDayCount;Ext.apply(this.commonTemplateFunctions,{me:this});this.setTpl(new Ext.XTemplate((d.tpl||this.getBaseTpl()).join(""),this.commonTemplateFunctions));this.setScrollable({direction:c.toUpperCase()==="DAY"?"vertical":false,directionLock:true});return c},collectData:function(d){var c=[];Ext.each(d,function(b,a){c.push(b.data)},this);return c},populateStore:function(){this.currentDate=this.currentDate||this.value||new Date();var k=true,j=this.currentDate,l=this.getStartDate(j),i=this.getTotalDays(j),h;this.getStore().suspendEvents();this.getStore().data.clear();for(var g=0;g<i;g++){l=this.getNextIterationDate(l,(g===0?0:1));k=(this.minDate&&l<this.minDate)||(this.maxDate&&l>this.maxDate);h=Ext.create("TouchCalendarViewModel",{today:this.isSameDay(l,new Date()),unselectable:k,selected:this.isSameDay(l,this.value)&&!k,prevMonth:(l.getMonth()<j.getMonth()),nextMonth:(l.getMonth()>j.getMonth()),weekend:this.isWeekend(l),date:l});this.getStore().add(h)}this.getStore().resumeEvents()},refreshDelta:function(g){var e=this.currentDate||new Date();var f=this.getDeltaDate(e,g);if(this.isOutsideMinMax(f)){return}this.currentDate=f;this.refresh();var h=this.getPeriodMinMaxDate();this.fireEvent("periodchange",this,h.min.get("date"),h.max.get("date"),(g>0?"forward":"back"))},getPeriodMinMaxDate:function(){return{min:this.getStore().data.first(),max:this.getStore().data.last()}},isOutsideMinMax:function(d){var c=false;if(this.getViewMode()==="MONTH"){c=((this.minDate&&Ext.Date.getLastDateOfMonth(d)<this.minDate)||(this.maxDate&&Ext.Date.getFirstDateOfMonth(d)>this.maxDate))}else{c=((this.minDate&&this.getWeekendDate(d)<this.minDate)||(this.maxDate&&this.getStartDate(d)>this.maxDate))}return c},onTableHeaderTap:function(c,d){d=Ext.fly(d);if(d.hasCls(this.getPrevPeriodCls())||d.hasCls(this.getNextPeriodCls())){this.refreshDelta(d.hasCls(this.getPrevPeriodCls())?-1:1)}},onTimeSlotTap:function(g){if(!g.getTarget("."+this.getUnselectableCls())){var h=Ext.fly(g.getTarget());this.selectCell(h);var e=this.getCellDate(h);var f=this.getValue()||this.currentDate;if(e.getTime()!==f.getTime()){this.setValue(e);this.fireEvent("selectionchange",this,e,f)}}},onComponentResize:function(b){this.syncHeight()},refresh:function(){this.populateStore();var b=this.getStore().getRange();this.setData(this.collectData(b));this.syncHeight()},syncHeight:function(){if(this.getViewMode().toUpperCase()!=="DAY"){var b=this.element.select("table",this.element.dom).first();if(b){b.setHeight(this.element.getHeight())}}},selectCell:function(e){var d=this.getSelectedItemCls();var f=this.element.select("."+d,this.element.dom);if(f){f.removeCls(d)}e.addCls(d);e.up("tr").addCls(d)},getDateRecord:function(b){return this.getStore().findBy(function(a){var d=Ext.Date.clearTime(a.get("date"),true).getTime();return d===Ext.Date.clearTime(b,true).getTime()},this)},getDayStartDate:function(b){return b},isSameDay:function(c,d){if(!c||!d){return false}return Ext.Date.clearTime(c,true).getTime()===Ext.Date.clearTime(d,true).getTime()},isWeekend:function(b){return b.getDay()===0||b.getDay()===6},getWeekendDate:function(c){var d=c.getDay()-this.getWeekStart();d=d<0?6:d;return new Date(c.getFullYear(),c.getMonth(),c.getDate()+0+d)},getCellDate:function(c){var d=c.dom.getAttribute("datetime");return this.stringToDate(d)},getDateCell:function(b){return this.element.select('td[datetime="'+this.getDateAttribute(b)+'"]',this.element.dom).first()},getDateAttribute:function(b){return Ext.Date.format(b,this.dateAttributeFormat)},getSelected:function(){var d=this.element.select("td."+this.getSelectedItemCls(),this.element.dom),c=[];d.each(function(a){c.push(this.getCellDate(a))},this);return c},stringToDate:function(b){return Ext.Date.parseDate(b,this.dateAttributeFormat)},applyTimeSlotDateTpls:function(b){Ext.Object.each(b,function(a,d){if(Ext.isString){b[a]=Ext.create("Ext.XTemplate",d)}},this);return b},statics:{MONTH:{dateAttributeFormat:"d-m-Y",getNextIterationDate:function(c,d){return new Date(c.getFullYear(),c.getMonth(),c.getDate()+(d===0?0:1))},getTotalDays:function(d){var c=Ext.Date.getFirstDateOfMonth(d);return this.isWeekend(c)?42:35},getStartDate:function(b){return Ext.bind(ux.TouchCalendarView.WEEK.getStartDate,this)(new Date(b.getFullYear(),b.getMonth(),1))},getDeltaDate:function(e,g){var h=e.getMonth()+g,f=new Date(e.getFullYear(),h,1);f.setDate(Ext.Date.getDaysInMonth(f)<e.getDate()?Ext.Date.getDaysInMonth(f):e.getDate());return f},periodRowDayCount:7},WEEK:{dateAttributeFormat:"d-m-Y",getNextIterationDate:function(c,d){return new Date(c.getFullYear(),c.getMonth(),c.getDate()+(d===0?0:1))},getTotalDays:function(b){return 7},getStartDate:function(c){var d=c.getDay()-this.getWeekStart();d=d<0?6:d;return new Date(c.getFullYear(),c.getMonth(),c.getDate()-0-d)},getDeltaDate:function(d,c){return new Date(d.getFullYear(),d.getMonth(),d.getDate()+(c*7))},periodRowDayCount:7},DAY:{dateAttributeFormat:"d-m-Y H:i",tpl:['<table class="{[this.me.getViewMode().toLowerCase()]}">',"<thead>","<tr>",'<th class="{[this.me.getPrevPeriodCls()]} style="display: block;">',"</th>","<th>",'<span>{[Ext.Date.format(values[0].date, "D jS M Y")]}</span>',"</th>",'<th class="{[this.me.getNextPeriodCls()]} style="display: block;"">',"</th>","</tr>","</thead>","<tbody>","<tr>",'<td colspan="3">','<table class="time-slot-table">','<tpl for=".">','<tr class="{[this.getTimeSlotRowCls(values.date)]}">','<td class="label">','<tpl if="!this.me.getHideHalfHourTimeSlotLabels() || !this.isHalfHour(values.date)">',"{date:this.formatDate()}","</tpl>","</td>",'<td class="time-block" colspan="2" datetime="{[this.me.getDateAttribute(values.date)]}">',"</td>","</tr>","</tpl>","</table>","</td>","</tr>","</tbody>","</table>"],getNextIterationDate:function(d,e){var f=d.getTime()+((e===0?0:1)*(this.getDayTimeSlotSize()*60*1000));return new Date(f)},getTotalDays:function(b){return 1440/this.getDayTimeSlotSize()},getStartDate:function(b){return Ext.Date.clearTime(b,true)},getDeltaDate:function(d,c){return new Date(d.getFullYear(),d.getMonth(),d.getDate()+c)},periodRowDayCount:1}}});
;
Ext.define("ux.WeiboPicker",{extend:"Ext.Picker",xtype:"weiboPicker",config:{toolbar:{ui:"light",title:"分享到"},value:{weibo:"sinaminiblog"},slots:[{name:"weibo",data:[{text:"新浪微博",value:"sinaminiblog"},{text:"人人网",value:"renren"}]}],weiboParams:null},show:function(a){this.setWeiboParams(a);this.callParent(arguments)},onDoneButtonTap:function(){var d=this.getWeiboParams();var a="http://api.bshare.cn/share/"+this.getValue().weibo+"?1=1";for(var b in d){var c=d[b];if(b=="url"){c=escape(c)}a=a+"&"+b+"="+c}window.open(a,"_system");this.endPick()},onCancelButtonTap:function(){this.endPick()},endPick:function(){this.hide();this.destroy()}});
;
Ext.define("ux.XCarousel",{extend:"Ext.Container",alternateClassName:"Ext.Carousel",xtype:"xcarousel",requires:["Ext.fx.easing.EaseOut","Ext.carousel.Item","Ext.carousel.Indicator","Ext.util.TranslatableGroup"],config:{direction:"horizontal",directionLock:false,animation:{duration:250,easing:{type:"ease-out"}},indicator:false,ui:"dark",displayCount:2,itemConfig:{width:"50%"},bufferSize:2,itemLength:true},itemLength:0,offset:0,flickStartOffset:0,flickStartTime:0,dragDirection:0,count:0,painted:false,activeIndex:-1,beforeInitialize:function(){this.element.on({dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",scope:this});this.element.on("resize","onSizeChange",this);this.carouselItems=[];this.orderedCarouselItems=[];this.inactiveCarouselItems=[];this.hiddenTranslation=0},updateBufferSize:function(n){console.dir("updateBufferSize");var l=Ext.carousel.Item,h=n*2+1,m=this.isRendered(),c=this.innerElement,g=this.carouselItems,f=g.length,e=this.getItemConfig(),d=this.getItemLength(),j=this.getDirection(),b=j==="horizontal"?"setWidth":"setHeight",a,k;for(a=f;a<h;a++){k=Ext.factory(e,l);if(d){k[b].call(k,d)}k.setLayoutSizeFlags(this.LAYOUT_BOTH);g.push(k);c.append(k.renderElement);if(m&&k.setRendered(true)){k.fireEvent("renderedchange",this,k,true)}}this.getTranslatable().setActiveIndex(n)},setRendered:function(g){var a=this.rendered;if(g!==a){this.rendered=g;var b=this.items.items,d=this.carouselItems,c,f,e;for(c=0,f=b.length;c<f;c++){e=b[c];if(!e.isInnerItem()){e.setRendered(g)}}for(c=0,f=d.length;c<f;c++){d[c].setRendered(g)}return true}return false},onSizeChange:function(){this.refreshSizing();this.refreshCarouselItems();this.refreshActiveItem()},onItemAdd:function(c,b){this.callParent(arguments);var d=this.getInnerItems().indexOf(c),a=this.getIndicator();if(a&&c.isInnerItem()){a.addIndicator()}if(d<=this.getActiveIndex()){this.refreshActiveIndex()}if(this.isIndexDirty(d)&&!this.isItemsInitializing){this.refreshActiveItem()}},doItemLayoutAdd:function(a){if(a.isInnerItem()){return}this.callParent(arguments)},onItemRemove:function(f,b){this.callParent(arguments);var h=this.getInnerItems().indexOf(f),a=this.getIndicator(),d=this.carouselItems,c,e,g;if(f.isInnerItem()&&a){a.removeIndicator()}if(h<=this.getActiveIndex()){this.refreshActiveIndex()}if(this.isIndexDirty(h)){for(c=0,e=d.length;c<e;c++){g=d[c];if(g.getComponent()===f){g.setComponent(null)}}this.refreshActiveItem()}},doItemLayoutRemove:function(a){if(a.isInnerItem()){return}this.callParent(arguments)},onInnerItemMove:function(b,c,a){if((this.isIndexDirty(c)||this.isIndexDirty(a))){this.refreshActiveItem()}},doItemLayoutMove:function(a){if(a.isInnerItem()){return}this.callParent(arguments)},isIndexDirty:function(b){var a=this.getActiveIndex(),c=this.getBufferSize();return(b>=a-c&&b<=a+c)},getTranslatable:function(){var a=this.translatable;if(!a){this.translatable=a=new Ext.util.TranslatableGroup;a.setItems(this.orderedCarouselItems);a.on("animationend","onAnimationEnd",this)}return a},onDragStart:function(f){var d=this.getDirection(),b=f.absDeltaX,a=f.absDeltaY,c=this.getDirectionLock();this.isDragging=true;if(c){if((d==="horizontal"&&b>a)||(d==="vertical"&&a>b)){f.stopPropagation()}else{this.isDragging=false;return}}this.getTranslatable().stopAnimation();this.dragStartOffset=this.offset;this.dragDirection=0},onDrag:function(j){if(!this.isDragging){return}var k=this.dragStartOffset,l=this.getDirection(),m=l==="horizontal"?j.deltaX:j.deltaY,a=this.offset,i=this.flickStartTime,c=this.dragDirection,b=Ext.Date.now(),h=this.getActiveIndex(),f=this.getMaxItemIndex(),d=c,g;if((h===0&&m>0)||(h===f&&m<0)){m*=0.5}g=k+m;if(g>a){c=1}else{if(g<a){c=-1}}if(c!==d||(b-i)>300){this.flickStartOffset=a;this.flickStartTime=b}this.dragDirection=c;this.setOffset(g)},onDragEnd:function(k){if(!this.isDragging){return}this.onDrag(k);this.isDragging=false;var a=Ext.Date.now(),j=this.itemLength,h=j/2,g=this.offset,n=this.getActiveIndex(),c=this.getMaxItemIndex(),i=0,m=g-this.flickStartOffset,b=a-this.flickStartTime,l=this.getIndicator(),f=this.getDisplayCount(),d;if(b>0&&Math.abs(m)>=10){d=m/b;if(Math.abs(d)>=1){if(d<0&&n<c-f+1){i=-1}else{if(d>0&&n>0){i=1}}}}if(i===0){if(n<c-f+1&&g<-h){i=-1}else{if(n>0&&g>h){i=1}}}if(l){l.setActiveIndex(n-i)}this.animationDirection=i;this.setOffsetAnimated(i*j)},applyAnimation:function(a){a.easing=Ext.factory(a.easing,Ext.fx.easing.EaseOut);return a},updateDirection:function(b){var a=this.getIndicator();this.currentAxis=(b==="horizontal")?"x":"y";if(a){a.setDirection(b)}},setOffset:function(a){this.offset=a;if(Ext.isNumber(this.itemOffset)){this.getTranslatable().translateAxis(this.currentAxis,a+this.itemOffset)}return this},setOffsetAnimated:function(b){var a=this.getIndicator();if(a){a.setActiveIndex(this.getActiveIndex()-this.animationDirection)}this.offset=b;this.getTranslatable().translateAxis(this.currentAxis,b+this.itemOffset,this.getAnimation());return this},onAnimationEnd:function(b){var c=this.getActiveIndex(),a=this.animationDirection,e=this.currentAxis,f=b[e],d=this.itemLength,g;if(a===-1){g=d+f}else{if(a===1){g=f-d}else{g=f}}g-=this.itemOffset;this.offset=g;this.setActiveItem(c-a)},refresh:function(){this.refreshSizing();this.refreshActiveItem()},refreshSizing:function(){var b=this.element,c=this.getItemLength(),a=this.getDisplayCount(),f={x:0,y:0},d,e;if(this.getDirection()==="horizontal"){e=b.getWidth()}else{e=b.getHeight()}this.hiddenTranslation=-e;if(c===null){c=e;d=0}else{c=this.getParent().element.getPageBox().width/a;d=0}this.itemLength=c;this.itemOffset=d;f[this.currentAxis]=c;this.getTranslatable().setItemLength(f)},refreshOffset:function(){this.setOffset(this.offset)},refreshActiveItem:function(){this.doSetActiveItem(this.getActiveItem())},getActiveIndex:function(){return this.activeIndex},refreshActiveIndex:function(){this.activeIndex=this.getInnerItemIndex(this.getActiveItem())},refreshCarouselItems:function(){var a=this.carouselItems,b,d,c;for(b=0,d=a.length;b<d;b++){c=a[b];c.getTranslatable().refresh()}this.refreshInactiveCarouselItems()},refreshInactiveCarouselItems:function(){var a=this.inactiveCarouselItems,f=this.hiddenTranslation,c=this.currentAxis,b,e,d;for(b=0,e=a.length;b<e;b++){d=a[b];d.translateAxis(c,f)}},getMaxItemIndex:function(){return this.innerItems.length-1},getInnerItemIndex:function(a){return this.innerItems.indexOf(a)},getInnerItemAt:function(a){return this.innerItems[a]},applyActiveItem:function(){var b=this.callParent(arguments),a;if(b){a=this.getInnerItemIndex(b);if(a!==-1){this.activeIndex=a;return b}}},doSetActiveItem:function(g){var q=this.getActiveIndex(),e=this.getMaxItemIndex(),m=this.getIndicator(),c=this.getBufferSize(),k=this.carouselItems.slice(),n=this.orderedCarouselItems,p={},o={},a,l,b,f,h,j,d;if(k.length===0){return}this.callParent(arguments);n.length=0;if(g){b=g.getId();o[b]=g;p[b]=c;if(q>0){for(f=1;f<=c;f++){h=q-f;if(h>=0){a=this.getInnerItemAt(h);b=a.getId();o[b]=a;p[b]=c-f}else{break}}}if(q<e){for(f=1;f<=c;f++){h=q+f;if(h<=e){a=this.getInnerItemAt(h);b=a.getId();o[b]=a;p[b]=c+f}else{break}}}for(f=0,j=k.length;f<j;f++){d=k[f];l=d.getComponent();if(l){b=l.getId();if(p.hasOwnProperty(b)){k.splice(f,1);f--;j--;delete o[b];n[p[b]]=d}}}for(b in o){if(o.hasOwnProperty(b)){a=o[b];d=k.pop();d.setComponent(a);n[p[b]]=d}}}this.inactiveCarouselItems.length=0;this.inactiveCarouselItems=k;this.refreshOffset();this.refreshInactiveCarouselItems();if(m){m.setActiveIndex(q)}},next:function(){this.setOffset(0);if(this.activeIndex===this.getMaxItemIndex()-this.getDisplayCount()+1){return false}this.animationDirection=-1;this.setOffsetAnimated(-this.itemLength);return true},previous:function(){this.setOffset(0);if(this.activeIndex===0){return false}this.animationDirection=1;this.setOffsetAnimated(this.itemLength);return true},applyIndicator:function(a,b){return Ext.factory(a,Ext.carousel.Indicator,b)},updateIndicator:function(a){if(a){this.insertFirst(a);a.setUi(this.getUi());a.on({next:"next",previous:"previous",scope:this})}},destroy:function(){var a=this.carouselItems.slice();this.carouselItems.length=0;Ext.destroy(a,this.getIndicator(),this.translatable);this.callParent();delete this.carouselItems}},function(){this.override({constructor:function(b){if(b&&"activeIndex" in b){Ext.Logger.deprecate("'activeIndex' config is deprecated, please use 'activeItem' config instead }");b.activeItem=b.activeIndex}this.callParent([b])}});Ext.deprecateClassMethod(this,{isVertical:function a(){return this.getDirection()==="vertical"},isHorizontal:function a(){return this.getDirection()==="horizontal"},prev:"previous"})});
;
Ext.define("ux.ImgView",{extend:"Ext.Container",xtype:"imgview",config:{},applyRightBtn:function(a){return Ext.factory(a,Ext.Button,this.getRightBtn())},applyLeftBtn:function(a){return Ext.factory(a,Ext.Button,this.getLeftBtn())},updateRightBtn:function(b,a){if(b){this.add(b);b.on({scope:this,tap:this.OnRightTap})}if(a){this.remove(a)}},updateLeftBtn:function(b,a){if(b){this.add(b);b.on({scope:this,tap:this.OnLeftTap})}if(a){this.remove(a)}},OnRightTap:function(){this.fireEvent("righttap",this.getRightBtn())},OnLeftTap:function(){this.fireEvent("lefttap",this.getLeftBtn())}});
;
Ext.define("ux.plugin.RefreshFn",{extend:"Ext.plugin.PullRefresh",alias:"plugin.refreshFn",requires:["Ext.DateExtras"],xtype:"refreshFn",config:{refreshFn:null,pullText:"下拉刷新",releaseText:"释放立即刷新",lastUpdatedText:"上次刷新时间：",loadedText:"加载成功",loadingText:"加载中...",lastUpdatedDateFormat:"Y-m-d H:i:s"},loadStore:function(){var b=this,c=b.getList(),a=c.getScrollable().getScroller();b.setViewState("loading");b.isReleased=false;Ext.defer(function(){a.on({scrollend:function(){if(b.getRefreshFn()){b.getRefreshFn().call(b,b)}else{b.fetchLatest()}b.resetRefreshState()},delay:100,single:true,scope:b});a.minPosition.y=0;a.scrollTo(null,0,true)},500,b)}});
;
Ext.define("ux.locale.Manager",{singleton:true,requires:["Ext.ComponentQuery","Ext.Ajax"],uses:["Ext.data.Store"],_ajaxConfig:{},_beforeLoad:Ext.emptyFn,_language:navigator.language?navigator.language.split("-")[0]:navigator.userLanguage.split("-")[0],_loaded:true,_loadingInd:true,_locale:{},_locales:[{abbr:"en",text:"English"},{abbr:"fr",text:"French"}],_tpl:"",_type:"script",_decoder:function(b,d,a){var c=a.responseText;return Ext.decode(c)},_callback:function(){this.applyLocales()},init:function(e){var c=this,b=c._type,a=c._callback,d=b==="script"?"loadScriptTag":"loadAjaxRequest";if(typeof e!=="function"){e=Ext.emptyFn}e=Ext.Function.createInterceptor(e,a,c);c[d](e)},loadAjaxRequest:function(h){var c=this;c._loaded=false;c._beforeLoad();var a=Ext.apply({},c._ajaxConfig),g=c._language,d=c._tpl.replace("{locale}",g),f=c._decoder,e=a.params||{},b;e.language=g;Ext.apply(a,{params:e,url:d,callback:function(j,k,i){b=f(j,k,i);c._locale=b;c._loaded=true;if(typeof h=="function"){Ext.Function.bind(h,c,[c,j,k,i])()}}});Ext.Ajax.request(a)},loadScriptTag:function(){console.log("<script/> support coming")},setConfig:function(a){Ext.Object.each(a,function(b,c){this["_"+b]=c},this);return this},applyLocales:function(){var a=Ext.ComponentQuery.query("component[enableLocale]"),f=0,e=a.length,d=this._language,b;for(;f<e;f++){b=a[f];if(typeof b.setLocale=="function"){b.setLocale(d)}}},isLoaded:function(){return this._loaded},get:function(h,e){var d=this,g=d._locale,f=h.indexOf("p:")==0,i=(f?h.substr(2):h).split("."),a=0,b=i.length,c;if(!d.isLoaded()){return e}for(;a<b;a++){h=i[a];if(g){g=g[h]}}c=g||e;if(f){return Ext.util.Inflector.pluralize(c)}else{return c}},getAvailable:function(b){var a=this._locales;if(b){return a}else{return new Ext.data.Store({fields:["abbr","text"],data:a})}},updateLocale:function(a){var b=this;b._language=a;if(b._loadingInd&&Ext.Viewport.setMasked){Ext.Viewport.setMasked({xtype:"loadmask",indicator:true,message:b.get("misc.loadingLocaleMsg","Loading...")})}b.init(function(c){if(b._loadingInd&&Ext.Viewport.setMasked){Ext.Viewport.setMasked(false)}})},getLanguage:function(){return this._language},isLocalable:function(d,b){if(!b){b={}}if(Ext.isObject(d.config.locales)){b.locales=d.config.locales}var a=b.locales||d.locales||(d.getLocales&&d.getLocales()),c=b.enableLocale||d.enableLocale||(d.getEnableLocale&&d.getEnableLocale());if(Ext.isObject(a)||c){Ext.apply(d,{enableLocale:true,locale:this})}return b}});
;
Ext.define("ux.locale.override.st.Component",{override:"Ext.Component",requires:["ux.locale.Manager"],enableLocale:false,locale:null,locales:null,constructor:function(a){var b=this;a=ux.locale.Manager.isLocalable(b,a);b.callParent([a]);if(b.enableLocale){b.setLocale(ux.locale.Manager.getLanguage())}},setLocale:function(b){var f=this,a=f.locales||f.getInitialConfig().locales,e=a.html,d=f.locale,c="";if(e){if(Ext.isObject(e)){c=e.defaultText;e=e.key}e=d.get(e,c);if(Ext.isString(e)){f.setHtml(e)}}}});
;
Ext.define("ux.locale.override.st.field.DatePicker",{override:"Ext.field.DatePicker",getPicker:function(){var b=this._picker,a=b&&!b.isPicker;b=this.callParent(arguments);if(a&&b.enableLocale){b.setLocale(ux.locale.Manager.getLanguage())}return b}});
;
Ext.define("ux.locale.override.st.field.Field",{override:"Ext.field.Field",requires:["ux.locale.override.st.Component"],setLocale:function(b){var e=this,a=e.locales||e.getInitialConfig().locales,c=a.label,g=a.placeHolder,d=e.locale,h="",f="";if(c){if(Ext.isObject(c)){f=c.defaultLabel;c=c.key}c=d.get(c,f);if(Ext.isString(c)){e.setLabel(c)}}if(g){if(Ext.isObject(g)){h=c.defaultPlaceholder;g=g.key}g=d.get(g,h);if(Ext.isString(g)){e.setPlaceHolder(g)}}e.callParent(arguments)}});
;
Ext.define("ux.locale.override.st.form.FieldSet",{override:"Ext.form.FieldSet",requires:["ux.locale.override.st.Component"],setLocale:function(c){var f=this,b=f.locales||f.getInitialConfig().locales,h=b.title,a=b.instructions,e=f.locale,d="",g="";if(h){if(Ext.isObject(h)){d=h.defaultText;h=h.key}h=e.get(h,d);if(Ext.isString(h)){f.setTitle(h)}}if(a){if(Ext.isObject(a)){g=a.defaultText;a=a.key}a=e.get(a,g);if(Ext.isString(a)){f.setInstructions(a)}}f.callParent(arguments)}});
;
Ext.define("ux.locale.override.st.navigation.Bar",{override:"Ext.navigation.Bar",requires:["ux.locale.Manager"],enableLocale:false,locale:null,locales:null,constructor:function(a){var b=this;ux.locale.Manager.isLocalable(b,a.view.config);b.callParent([a]);if(b.enableLocale){b.setLocale(ux.locale.Manager.getLanguage())}},onViewAdd:function(c,e){var d=this,b=d.backButtonStack,a,f;d.endAnimation();if(e.enableLocale){f=(e.getTitle)?e.getTitle():e.title||e.config.title}else{f=(e.getTitle)?e.getTitle():e.config.title}b.push(f||"&nbsp;");a=b.length>1;d.doChangeView(c,a,false)},setLocale:function(f){var d=this,a=d.config.view,c=a.getInnerItems();for(var b=0;b<c.length;b++){var h=c[b];if(h.enableLocale){h.setLocale(f);var e=(h.getTitle)?h.getTitle():h.title;d.backButtonStack[b]=e}}d.setTitle(d.getTitleText());var j=d.getBackButton();var g=d.getBackButtonText();if(j&&g){j.setText(g)}}});
;
Ext.define("ux.locale.override.st.navigation.View",{override:"Ext.navigation.View",requires:["ux.locale.Manager"],enableLocale:false,locale:null,locales:null,constructor:function(a){var b=this;a=ux.locale.Manager.isLocalable(b,a);b.callParent([a]);if(b.enableLocale){b.setLocale(ux.locale.Manager.getLanguage())}},setLocale:function(b){var e=this,a=e.locales||e.getInitialConfig().locales,f=a.defaultBackButtonText,c="",d=e.locale;if(f){if(Ext.isObject(f)){c=f.defaultText;f=f.key}f=d.get(f,c);if(Ext.isString(f)){e.setDefaultBackButtonText(f)}}}});
;
Ext.define("ux.locale.override.st.picker.Date",{override:"Ext.picker.Date",setLocale:function(m){var i=this,c=i.locales||i.getInitialConfig().locales,a=c.months,l=c.dayText,h=c.monthText,j=c.yearText,d=c.slotOrder,e=i.locale,k="",b="Day",f="Month",g="Year",q=["month","day","year"],p,o,n;if(a){if(Ext.isObject(a)){k=a.defaultText;a=a.key}a=e.get(a,k);if(Ext.isObject(a)){p=this.down("pickerslot[name=month]");o=p&&p.getStore();if(o){o.each(function(r){n=r.get("value");r.set("text",a[n])})}}}if(l){if(Ext.isObject(l)){b=l.defaultDay;l=l.key}l=e.get(l,b);if(Ext.isString(l)){i.setDayText(l)}}if(h){if(Ext.isObject(h)){f=h.defaultMonth;h=h.key}h=e.get(h,f);if(Ext.isString(h)){i.setMonthText(h)}}if(j){if(Ext.isObject(j)){g=j.defaultYear;j=j.key}j=e.get(j,g);if(Ext.isString(j)){i.setYearText(j)}}if(d){if(Ext.isObject(d)){q=d.defaultSlotOrder;d=d.key}d=Ext.JSON.decode(e.get(d,q));if(Ext.isArray(d)){i.setSlotOrder(d)}}i.callParent(arguments)}});
;
Ext.define("ux.locale.override.st.picker.Picker",{override:"Ext.picker.Picker",config:{doneButton:{locales:{text:"buttons.done"}},cancelButton:{locales:{text:"buttons.cancel"}}}});
;
Ext.define("ux.locale.override.st.Button",{override:"Ext.Button",requires:["ux.locale.override.st.Component"],constructor:function(){this.callSuper(arguments)},setLocale:function(b){var e=this,a=e.locales||e.getInitialConfig().locales,f=a.text,d=e.locale,c="";if(f){if(Ext.isObject(f)){c=f.defaultText;f=f.key}f=d.get(f,c);if(Ext.isString(f)){e.setText(f);e.refreshIconAlign()}}e.callParent(arguments)}});
;
Ext.define("ux.locale.override.st.Container",{override:"Ext.Container",requires:["ux.locale.override.st.Component"],setLocale:function(b){var f=this,e=f.getTab(),a=f.locales||f.getInitialConfig().locales,g=a.title,d=f.locale,c="";if(g){if(Ext.isObject(g)){c=g.defaultText;g=g.key}g=d.get(g,c);if(Ext.isString(g)){f.title=g;if(e){e.setTitle(g)}}}this.callParent(arguments)},getTab:function(){var e=this,d,a,b,c;if(e.tab){return e.tab}d=e.up("tabpanel");if(!d){return}a=d.getTabBar();b=d.getInnerItems();c=Ext.Array.indexOf(b,e);return a.getComponent(c)}});
;
Ext.define("ux.locale.override.st.DataView",{override:"Ext.dataview.DataView",requires:["ux.locale.override.st.Component"],setLocale:function(c){var e=this,b=e.locales||e.getInitialConfig().locales,a=b.emptyText,d=e.locale,f="";if(a){if(Ext.isObject(a)){f=a.defaultEmptyText;a=a.key}a=d.get(a,f);if(Ext.isString(a)){e.setEmptyText(a)}}this.callParent(arguments)},onStoreUpdate:function(c,b,d,f){var e=this,a=e.container;f=(typeof f==="undefined")?d:f;if(f!==d){a.updateAtNewIndex(f,d,b);if(e.isSelected(b)){e.doItemSelect(e,b)}}else{if(e.getViewItems().length>0){a.updateListItem(b,e.getViewItems()[d])}}}});
;
Ext.define("ux.locale.override.st.TitleBar",{override:"Ext.TitleBar",requires:["ux.locale.override.st.Component"],setLocale:function(b){var e=this,a=e.locales||e.getInitialConfig().locales,f=a.title,d=e.locale,c="";if(f){if(Ext.isObject(f)){c=f.defaultText;f=f.key}f=d.get(f,c);if(Ext.isString(f)){e.setTitle(f)}}this.callParent(arguments)}});
;
Ext.define("ux.plugin.ConHref",{alias:"plugin.conHref",xtype:"conHref",config:{cmp:null,scrollable:{direction:"vertical",directionLock:true,indicators:false}},constructor:function(a){this.initConfig(a);this.callParent([a])},init:function(a){this.setCmp(a)},updateCmp:function(a,b){if(a){a.element.on({tap:"onTap",delegate:"a",scope:this});a.element.on({tap:"onTapImg",delegate:"img",scope:this});a.setScrollable(this.getScrollable())}},onTap:function(g,c){var d=g.getTarget("a");if(d){d.onclick=function(){return false};var f=g.getTarget("img");if(!f){window.open(d.href,"_system","location=yes")}}},onTapImg:function(f,a){var c=f.getTarget("img");if(c){var d=this.getCmp();d.fireAction("imgTap",[d,c.src],"doImgTap")}}});
;
Ext.define("ux.plugin.ConTpl",{alias:"plugin.conTpl",xtype:"conTpl",config:{cmp:null,pressedCls:"x-button-pressing",delegate:"div.x-button"},constructor:function(a){this.initConfig(a);this.callParent([a])},init:function(a){this.setCmp(a)},updateCmp:function(a,b){if(a){a.element.on({tap:"onTap",touchstart:"onPress",touchend:"onRelease",delegate:this.getDelegate(),scope:this})}},onTap:function(f){var c=this.getCmp(),b=f.getTarget(this.getDelegate(),null,true),a=b.getAttribute("fire"),d="do"+a;c.fireAction(a,[c,b],d)},onPress:function(c,b){var a=c.getTarget(this.getDelegate(),null,true);a.addCls(this.getPressedCls())},onRelease:function(c,b){var a=c.getTarget(this.getDelegate(),null,true);a.removeCls(this.getPressedCls())}});
;
Ext.define("ux.plugin.PanelRefreshFn",{extend:"ux.plugin.RefreshFn",alias:"plugin.panelRefreshFn",xtype:"panelRefreshFn",config:{refreshFn:null},init:function(d){if((this.isList=d.getStore&&d.getStore()?true:false)==true){return this.callParent(arguments)}this.setList(d);var b=this,c=b.getPullTpl(),a=b.element;b.scrollable=d.getScrollable().getScroller();if(!b.scrollable){return}b.lastUpdated=new Date();d.add(b);c.overwrite(a,{message:b.getPullRefreshText(),lastUpdated:b.lastUpdated},true);b.loadingElement=a.getFirstChild();b.messageEl=a.down(".x-list-pullrefresh-message");b.updatedEl=a.down(".x-list-pullrefresh-updated");window.x=b.updatedEl;b.maxScroller=b.scrollable.getMaxPosition();b.scrollable.on({maxpositionchange:b.setMaxScroller,scroll:b.onScrollChange,scope:b})},loadStore:function(){if(this.isList==true){return this.callParent(arguments)}var a=this;a.setViewState("loading");a.isReleased=false;a.getRefreshFn().call(a,a)},refreshReady:function(){this.scrollable.minPosition.y=0;this.scrollable.scrollTo(null,0,true);this.resetRefreshState()},onBounceTop:function(e){var b=this,d=b.pullHeight,c=b.getList(),a=c.getScrollable().getScroller();if(!b.isReleased){if(!d){b.onPainted();d=b.pullHeight}if(!b.isRefreshing&&-e>=d+10){b.isRefreshing=true;b.setViewState("release");a.getContainer().onBefore({dragend:"onScrollerDragEnd",single:true,scope:b})}else{if(b.isRefreshing&&-e<d+10){b.isRefreshing=false;b.setViewState("pull")}}}if(this.isList==true){b.getTranslatable().translate(0,-e)}}});
;
Ext.define("ux.plugin.SwipeTabs",{alias:"plugin.swipetabs",xtype:"swipetabs",config:{cmp:null,allowOverflow:false,animation:{duration:300,easing:"ease-out",type:"slide"}},constructor:function(a){this.initConfig(a);this.callParent([a])},init:function(a){this.setCmp(a)},updateCmp:function(a,b){if(b){b.element.un("swipe",this.onSwipe)}if(a){a.element.on("swipe",this.onSwipe,this)}},onSwipe:function(i){var j=this.getCmp(),c=this.getAllowOverflow(),d=this.getAnimation(),l=i.direction,f=j.getActiveItem(),b=j.getInnerItems(),n=b.length-1,m=Ext.Array.indexOf(b,f),k=m+(l==="left"?1:-1),g;if(k<0){if(c){g=b[n];k=n}}else{if(k>n){if(c){g=b[0];k=0}}else{g=b[k]}}if(g){d=Ext.apply({},{direction:l},d);j.animateActiveItem(g,d);var a=j.getMoveNum();if(a&&a>0){var h=j.getTabBar().getScrollable().getScroller();h.scrollTo(k*a,0)}}}});
;
cordova.define("cordova/plugins/Pgalipay",function(d,c,e){var b=d("cordova/exec");var a=function(){};a.prototype.alipay=function(l,j,k,g,i,f,h){if(h==null){h=function(){}}if(typeof h!="function"){console.log("pgbaidumap.scan failure: failure parameter not a function");return}if(typeof f!="function"){console.log("pgbaidumap.scan failure: success callback parameter must be a function");return}b(f,h,"Pgalipay","alipay",[l,j,k,g,i])};var a=new a();e.exports=a});if(!window.plugins){window.plugins={}}if(!window.plugins.Pgalipay){window.plugins.Pgalipay=cordova.require("cordova/plugins/Pgalipay")};
;
"use strict";function Calendar(){}Calendar.prototype.getCreateCalendarOptions=function(){return{calendarName:null,calendarColor:null}};Calendar.prototype.createCalendar=function(c,a,b){var d;if(typeof c=="string"){d={calendarName:c}}else{d=c}var f=Calendar.prototype.getCreateCalendarOptions();for(var e in d){if(d.hasOwnProperty(e)){f[e]=d[e]}}cordova.exec(a,b,"Calendar","createCalendar",[f])};Calendar.prototype.deleteCalendar=function(c,a,b){cordova.exec(a,b,"Calendar","deleteCalendar",[{calendarName:c}])};Calendar.prototype.openCalendar=function(c,a,b){if(!(c instanceof Date)){c=new Date()}cordova.exec(a,b,"Calendar","openCalendar",[{date:c.getTime()}])};Calendar.prototype.getCalendarOptions=function(){return{firstReminderMinutes:60,secondReminderMinutes:null,recurrence:null,recurrenceEndDate:null,calendarName:null}};Calendar.prototype.createEventWithOptions=function(h,i,g,a,f,j,b,e){if(!(a instanceof Date&&f instanceof Date)){e("startDate and endDate must be JavaScript Date Objects");return}var d=Calendar.prototype.getCalendarOptions();for(var c in j){if(j.hasOwnProperty(c)){d[c]=j[c]}}if(j.recurrenceEndDate!=null){d.recurrenceEndTime=j.recurrenceEndDate.getTime()}cordova.exec(b,e,"Calendar","createEventWithOptions",[{title:h,location:i,notes:g,startTime:a instanceof Date?a.getTime():null,endTime:f instanceof Date?f.getTime():null,options:d}])};Calendar.prototype.createEvent=function(g,c,e,b,f,a,d){Calendar.prototype.createEventWithOptions(g,c,e,b,f,{},a,d)};Calendar.prototype.createEventInteractively=function(g,c,e,b,f,a,d){cordova.exec(a,d,"Calendar","createEventInteractively",[{title:g,location:c,notes:e,startTime:b instanceof Date?b.getTime():null,endTime:f instanceof Date?f.getTime():null,options:Calendar.prototype.getCalendarOptions()}])};Calendar.prototype.createEventInNamedCalendar=function(h,c,e,b,g,f,a,d){if(!(b instanceof Date&&g instanceof Date)){d("startDate and endDate must be JavaScript Date Objects")}cordova.exec(a,d,"Calendar","createEventInNamedCalendar",[{title:h,location:c,notes:e,startTime:b instanceof Date?b.getTime():null,endTime:g instanceof Date?g.getTime():null,calendarName:f}])};Calendar.prototype.deleteEvent=function(g,c,e,b,f,a,d){if(!(b instanceof Date&&f instanceof Date)){d("startDate and endDate must be JavaScript Date Objects")}cordova.exec(a,d,"Calendar","deleteEvent",[{title:g,location:c,notes:e,startTime:b instanceof Date?b.getTime():null,endTime:f instanceof Date?f.getTime():null}])};Calendar.prototype.deleteEventFromNamedCalendar=function(h,c,e,b,g,f,a,d){cordova.exec(a,d,"Calendar","deleteEventFromNamedCalendar",[{title:h,location:c,notes:e,startTime:b instanceof Date?b.getTime():null,endTime:g instanceof Date?g.getTime():null,calendarName:f}])};Calendar.prototype.findEvent=function(g,c,e,b,f,a,d){cordova.exec(a,d,"Calendar","findEvent",[{title:g,location:c,notes:e,startTime:b instanceof Date?b.getTime():null,endTime:f instanceof Date?f.getTime():null}])};Calendar.prototype.findAllEventsInNamedCalendar=function(c,a,b){cordova.exec(a,b,"Calendar","findAllEventsInNamedCalendar",[{calendarName:c}])};Calendar.prototype.modifyEvent=function(i,j,g,d,f,a,k,l,b,h,c,e){if(!(b instanceof Date&&h instanceof Date)){e("newStartDate and newEndDate must be JavaScript Date Objects");return}cordova.exec(c,e,"Calendar","modifyEvent",[{title:i,location:j,notes:g,startTime:d instanceof Date?d.getTime():null,endTime:f instanceof Date?f.getTime():null,newTitle:a,newLocation:k,newNotes:l,newStartTime:b instanceof Date?b.getTime():null,newEndTime:h instanceof Date?h.getTime():null}])};Calendar.prototype.modifyEventInNamedCalendar=function(i,j,g,d,f,a,k,l,b,h,m,c,e){if(!(b instanceof Date&&h instanceof Date)){e("newStartDate and newEndDate must be JavaScript Date Objects");return}cordova.exec(c,e,"Calendar","modifyEventInNamedCalendar",[{title:i,location:j,notes:g,startTime:d instanceof Date?d.getTime():null,endTime:f instanceof Date?f.getTime():null,newTitle:a,newLocation:k,newNotes:l,newStartTime:b instanceof Date?b.getTime():null,newEndTime:h instanceof Date?h.getTime():null,calendarName:m}])};Calendar.prototype.listEventsInRange=function(b,d,a,c){cordova.exec(a,c,"Calendar","listEventsInRange",[{startTime:b instanceof Date?b.getTime():null,endTime:d instanceof Date?d.getTime():null}])};Calendar.prototype.listCalendars=function(a,b){cordova.exec(a,b,"Calendar","listCalendars",[])};Calendar.install=function(){if(!window.plugins){window.plugins={}}window.plugins.calendar=new Calendar();return window.plugins.calendar};cordova.addConstructor(Calendar.install);
;
cordova.define("cordova/plugins/Pgwxpay",function(c,b,e){var a=c("cordova/exec");var d=function(){};d.prototype.wxpay=function(k,i,j,g,f,h){if(h==null){h=function(){}}if(typeof h!="function"){console.log("pgbaidumap.scan failure: failure parameter not a function");return}if(typeof f!="function"){console.log("pgbaidumap.scan failure: success callback parameter must be a function");return}a(f,h,"Pgwxpay","wxpay",[{out_trade_no:k,url:i,bodtxt:j,total_fee:g}])};d.prototype.getcode=function(f,g){if(g==null){g=function(){}}if(typeof g!="function"){console.log("pgbaidumap.scan failure: failure parameter not a function");return}if(typeof f!="function"){console.log("pgbaidumap.scan failure: success callback parameter must be a function");return}a(f,g,"Pgwxpay","getcode",[])};var d=new d();e.exports=d});if(!window.plugins){window.plugins={}}if(!window.plugins.Pgwxpay){window.plugins.Pgwxpay=cordova.require("cordova/plugins/Pgwxpay")};
;
cordova.define("cordova/plugins/Baidushare",function(d,c,e){var b=d("cordova/exec");var a=function(){};a.prototype.bdshare=function(k,i,h,j,f,g){if(g==null){g=function(){}}if(typeof g!="function"){console.log("Baidushare failure: failure parameter not a function");return}if(typeof f!="function"){console.log("Baidushare failure: success callback parameter must be a function");return}b(f,g,"Baidushare","bdshare",[{title:k,content:i,url:h,imageurl:j}])};var a=new a();e.exports=a});if(!window.plugins){window.plugins={}}if(!window.plugins.Baidushare){window.plugins.Baidushare=cordova.require("cordova/plugins/Baidushare")};
;
cordova.define("cordova/plugins/BaiduMap",function(c,b,e){var a=c("cordova/exec");var d=function(){};d.prototype.baiduad=function(g,i,f,h){if(h==null){h=function(){}}if(typeof h!="function"){console.log("pgbaidumap.scan failure: failure parameter not a function");return}if(typeof f!="function"){console.log("pgbaidumap.scan failure: success callback parameter must be a function");return}a(f,h,"BaiduMap","baiduad",[{address:g,city:i}])};var d=new d();e.exports=d});if(!window.plugins){window.plugins={}}if(!window.plugins.BaiduMap){window.plugins.BaiduMap=cordova.require("cordova/plugins/BaiduMap")}function adtoloc(d){var c="0cvMlj16I4Q6TdAtvWcA85vk";var a=encodeURIComponent(d);var b="http://api.map.baidu.com/geocoder/v2/?ak="+c+"&output=json&address="+a;$.getJSON(b,function(f){var g=f.result.location.lng;var h=f.result.location.lat;var e=h+","+g;console.log("location:"+e);return e})};
;
cordova.define("cordova/plugins/PgmediaPlayer",function(c,b,e){var a=c("cordova/exec");var d=function(){};d.prototype.vplay=function(h,f,g){if(g==null){g=function(){}}if(typeof g!="function"){console.log("PgmediaPlayer failure: failure parameter not a function");return}if(typeof f!="function"){console.log("PgmediaPlayer failure: success callback parameter must be a function");return}a(f,g,"PgmediaPlayer","vplay",[h])};var d=new d();e.exports=d});if(!window.plugins){window.plugins={}}if(!window.plugins.PgmediaPlayer){window.plugins.PgmediaPlayer=cordova.require("cordova/plugins/PgmediaPlayer")};
;

;
